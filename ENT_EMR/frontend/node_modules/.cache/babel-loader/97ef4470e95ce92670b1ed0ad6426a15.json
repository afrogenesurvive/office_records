{"ast":null,"code":"import _classCallCheck from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import S3 from'react-aws-s3';// import S3FileUpload from 'react-s3';\nimport React,{Component}from'react';import UpdateUserForm from'../components/Forms/UpdateUserForm';import Container from'react-bootstrap/Container';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import Button from'react-bootstrap/Button';import SidebarPage from'./Sidebar';import Tabs from'react-bootstrap/Tabs';import Tab from'react-bootstrap/Tab';import Nav from'react-bootstrap/Nav';import AlertBox from'../components/AlertBox';import AttachmentViewer from'../components/AttachmentViewer';import PdfCreator from'../components/PdfCreator';import UpdateUserFieldForm from'../components/Forms/UpdateUserFieldForm';import UpdateUserAttendanceForm from'../components/Forms/UpdateUserAttendanceForm';import UpdateUserAttachmentForm from'../components/Forms/UpdateUserAttachmentForm';import UpdateUserLeaveForm from'../components/Forms/UpdateUserLeaveForm';import ThisUserProfile from'../components/Users/thisUserProfile';import AuthContext from'../context/auth-context';import'./Users.css';var ThisUserPage=/*#__PURE__*/function(_Component){_inherits(ThisUserPage,_Component);function ThisUserPage(){var _getPrototypeOf2;var _this;_classCallCheck(this,ThisUserPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(ThisUserPage)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={user:null,users:[],updating:false,isLoading:false,userUpdateField:null,userAlert:null,canDelete:null,showAttachment:false,createPdf:false,pdfData:null,showThisAttachmentFile:null,showThisAttachmentType:null};_this.isActive=true;_this.startUpdateUserHandler=function(){_this.setState({updating:true});console.log(\"UpdateUserForm...\");};_this.modalConfirmUpdateHandler=function(event){var token=_this.context.token;var userId=_this.context.userId;var selectedUserId=_this.context.selectedUser._id;if(userId!==selectedUserId&&_this.context.user.role!=='admin'){console.log(\"Not the creator or Admin! No edit permission!!\");_this.setState({userAlert:\"Not the creator or Admin! No edit permission!!\"});selectedUserId=null;}console.log(\"UpdateUserFormData:  \",event.target.formGridEmail.value);_this.setState({updating:false});var email=event.target.formGridEmail.value;var password=event.target.formGridPassword.value;var name=event.target.formGridName.value;var role=_this.context.user.role;var dob=event.target.formGridDob.value;var phone=event.target.formGridPhone.value;var addressNumber=event.target.formGridAddressNumber.value;var addressStreet=event.target.formGridAddressStreet.value;var addressTown=event.target.formGridAddressTown.value;var addressParish=event.target.formGridAddressParish.value;var addressPostOffice=event.target.formGridAddressPostOffice.value;var employmentDate=event.target.formGridEmploymentDate.value;if(event.target.formGridEmploymentDateTodayCheckbox.checked===true){employmentDate=new Date().toISOString().slice(0,10);}var terminationDate=event.target.formGridTerminationDate.value;if(event.target.formGridTerminationDateTodayCheckbox.checked===true){terminationDate=new Date().toISOString().slice(0,10);}if(email.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");email=_this.context.user.email;}if(password.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");password=_this.context.user.password;}if(name.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");name=_this.context.user.name;}// if (role.trim().length === 0) {\n//   console.log(\"blank fields detected!!!...filling w/ previous data...\");\n//   role = this.state.user.role;\n// }\nif(dob.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");dob=_this.context.user.dob;}if(phone.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");phone=_this.context.user.phone;}if(addressNumber.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressNumber=_this.context.user.address.number;}if(addressStreet.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressStreet=_this.context.user.address.street;}if(addressTown.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressTown=_this.context.user.address.town;}if(addressParish.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressParish=_this.context.user.address.parish;}if(addressPostOffice.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressPostOffice=_this.context.user.address.postOffice;}if(employmentDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");employmentDate=_this.context.user.employmentDate;}if(terminationDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");terminationDate=_this.context.user.terminationDate;}console.log(\"\\n      updating user profile...\\n      userId: \".concat(userId,\"\\n      email: \").concat(email,\",\\n      password: \").concat(password,\",\\n      name: \").concat(name,\",\\n      role: \").concat(role,\",\\n      dob: \").concat(dob,\",\\n      phone: \").concat(phone,\",\\n      addressNumber: \").concat(addressNumber,\",\\n      addressStreet: \").concat(addressStreet,\",\\n      addressTown: \").concat(addressTown,\",\\n      addressParish: \").concat(addressParish,\",\\n      addressPostOffice: \").concat(addressPostOffice,\",\\n      employmentDate: \").concat(employmentDate,\",\\n      terminationDate: \").concat(terminationDate,\",\\n      \"));var requestBody={query:\"\\n        mutation {updateUser(userId:\\\"\".concat(userId,\"\\\",selectedUserId:\\\"\").concat(userId,\"\\\",userInput: {email:\\\"\").concat(email,\"\\\",password:\\\"\").concat(password,\"\\\",name:\\\"\").concat(name,\"\\\",dob:\\\"\").concat(dob,\"\\\",addressNumber:\").concat(addressNumber,\",addressStreet:\\\"\").concat(addressStreet,\"\\\",addressTown:\\\"\").concat(addressTown,\"\\\",addressParish:\\\"\").concat(addressParish,\"\\\", addressPostOffice:\\\"\").concat(addressPostOffice,\"\\\",phone:\\\"\").concat(phone,\"\\\",role:\\\"\").concat(role,\"\\\",employmentDate:\\\"\").concat(employmentDate,\"\\\",terminationDate:\\\"\").concat(terminationDate,\"\\\"})\\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n        \")};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData));var updatedUser=resData.data.updateUser;console.log(\"updatedUser:  \",JSON.stringify(updatedUser));_this.state.users.push(updatedUser);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert,user:updatedUser});_this.getThisUser();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.modalConfirmUpdateFieldHandler=function(event){var token=_this.context.token;var userId=_this.context.userId;var selectedUserId=_this.context.selectedUser._id;if(userId!==selectedUserId&&_this.context.user.role!=='admin'){console.log(\"Not the creator or Admin! No edit permission!!\");_this.setState({userAlert:\"Not the creator or Admin! No edit permission!!\"});selectedUserId=null;}console.log(\"UpdateUserFieldFormData:  \",event.target.formGridField.value);_this.setState({updating:false});var field=event.target.formGridField.value;var query=event.target.formGridQuery.value;var requestBody={query:\"\\n            mutation{updateUserField(userId:\\\"\".concat(userId,\"\\\",selectedUserId:\\\"\").concat(userId,\"\\\",field:\\\"\").concat(field,\"\\\",query:\\\"\").concat(query,\"\\\")\\n            {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n          \")};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData.data.updateUserField));var updatedUserId=resData.data.updateUserField._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.updateUserField);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});_this.getThisUser();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.updateUserAttendanceHandler=function(event){var token=_this.context.token;var userId=_this.state.user._id;// let selectedUserId = this.context.selectedUser._id;\n// if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n//   console.log(\"Not the creator or Admin! No edit permission!!\");\n//   selectedUserId = null;\n// }\nconsole.log(\"UpdateUserAttendanceFormData:  \",event.target.formGridAttendanceStatus.value);_this.setState({updating:false,userUpdateField:null});var attendanceDate=event.target.formGridAttendanceDate.value;if(event.target.formGridAttendanceDateTodayCheckbox.checked===true){attendanceDate=new Date().toISOString().slice(0,10);}var attendanceStatus=event.target.formGridAttendanceStatus.value;var attendanceDescription=event.target.formGridAttendanceDescription.value;if(attendanceDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");attendanceDate=_this.context.selectedUser.attendanceDate;}if(attendanceStatus.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");attendanceStatus=_this.context.selectedUser.attendanceStatus;}if(attendanceDescription.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");attendanceDescription=_this.context.selectedUser.attendanceDescription;}console.log(\"\\n      adding user attendance item...\\n      userId: \".concat(userId,\",\\n      attendanceDate: \").concat(attendanceDate,\",\\n      attendanceStatus: \").concat(attendanceStatus,\",\\n      attendanceDescription: \").concat(attendanceDescription,\"\\n      \"));var requestBody={query:\"\\n          mutation {updateUserAttendance(userId:\\\"\".concat(userId,\"\\\", selectedUserId:\\\"\").concat(userId,\"\\\",userInput:{attendanceDate:\\\"\").concat(attendanceDate,\"\\\",attendanceStatus:\\\"\").concat(attendanceStatus,\"\\\",attendanceDescription:\\\"\").concat(attendanceDescription,\"\\\"})\\n          {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n        \")};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData.data.updateUserAttendance));var updatedUserId=resData.data.updateUserAttendance._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.updateUserAttendance);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});_this.getThisUser();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.updateUserLeaveHandler=function(event){var token=_this.context.token;var userId=_this.context.userId;var selectedUserId=_this.context.selectedUser._id;if(userId!==selectedUserId&&_this.context.user.role!=='admin'){console.log(\"Not the creator or Admin! No edit permission!!\");_this.setState({userAlert:\"Not the creator or Admin! No edit permission!!\"});selectedUserId=null;}console.log(\"UpdateUserLeaveFormData:  \",event.target.formGridLeaveType.value);_this.setState({updating:false,userUpdateField:null});var leaveType=event.target.formGridLeaveType.value;var leaveTitle=event.target.formGridLeaveTitle.value;var leaveStartDate=event.target.formGridLeaveStartDate.value;if(event.target.formGridLeaveStartDateTodayCheckbox.checked===true){leaveStartDate=new Date().toISOString().slice(0,10);}var leaveEndDate=event.target.formGridLeaveEndDate.value;if(event.target.formGridLeaveEndDateTodayCheckbox.checked===true){leaveEndDate=new Date().toISOString().slice(0,10);}if(leaveType.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");leaveType=_this.context.selectedUser.leaveType;}if(leaveTitle.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");leaveTitle=_this.context.selectedUser.leaveTitle;}if(leaveStartDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");leaveStartDate=_this.context.selectedUser.leaveStartDate;}if(leaveEndDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");leaveEndDate=_this.context.selectedUser.leaveEndDate;}console.log(\"\\n      adding user attendance item...\\n      userId: \".concat(userId,\",\\n      selectedUserId: \").concat(selectedUserId,\"\\n      leave: {\\n        type: \").concat(leaveType,\",\\n        title: \").concat(leaveTitle,\",\\n        startDate: \").concat(leaveStartDate,\",\\n        endDate: \").concat(leaveEndDate,\"\\n      }\\n      \"));var requestBody={query:\"\\n          mutation {updateUserLeave(userId:\\\"\".concat(userId,\"\\\", selectedUserId:\\\"\").concat(userId,\"\\\",userInput:{leaveType:\\\"\").concat(leaveType,\"\\\",leaveTitle:\\\"\").concat(leaveTitle,\"\\\",leaveStartDate:\\\"\").concat(leaveStartDate,\"\\\",leaveEndDate:\\\"\").concat(leaveEndDate,\"\\\"})\\n          {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n        \")};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData.data));var updatedUserId=resData.data.updateUserLeave._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.updateUserLeave);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});_this.getThisUser();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.updateUserAttachmentHandler=function(event){var token=_this.context.token;var userId=_this.context.userId;// let selectedUserId = this.context.selectedUser._id;\n// if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n//   console.log(\"Not the creator or Admin! No edit permission!!\");\n//   selectedUserId = null;\n// }\n// if (userId !== selectedUserId && this.context.user.role !== \"admin\" ) {\n//   console.log(\"Not the creator or Admin! No edit permission!!\");\n//   this.setState({userAlert: \"Not the creator or Admin! No edit permission!!\"})\n//     selectedUserId = null;\n// }\nconsole.log(\"UpdateUserAttachmentFormData:  \");_this.setState({updating:false,userUpdateField:null});// let attachmentName = event.target.formGridAttachmentName.value;\nvar attachmentFormat=event.target.formGridAttachmentFormat.value;var attachmentPath=\"uploads/staff/\"+userId+\"/attachments\";// let attachmentPath = event.target.formGridAttachmentPath.value;\nvar file=AuthContext._currentValue.file;console.log(\"\\n    uploading to s3...\\n    file.name: \".concat(file.name,\",\\n    AuthContext._currentValue.file: \").concat(AuthContext._currentValue.file,\",\\n    \"));var config={bucketName:_this.context.creds.s3.bucketName,dirName:attachmentPath,region:_this.context.creds.s3.region,accessKeyId:_this.context.creds.s3.accessKeyId,secretAccessKey:_this.context.creds.s3.secretAccessKey};var ReactS3Client=new S3(config);var newFileName=file.name;var attachmentName=newFileName;ReactS3Client.uploadFile(file,newFileName).then(function(data){console.log(data);_this.setState({userAlert:\"attachment upload success!\"});}).catch(function(err){console.error(err);_this.setState({userAlert:\"upload error:  \"+err});});if(attachmentName.trim().length===0||attachmentFormat.trim().length===0||attachmentPath.trim().length===0){console.log(\"blank fields detected!!! try again\");return;}var userAttachment={attachmentName:attachmentName,attachmentFormat:attachmentFormat,attachmentPath:attachmentPath};console.log(\"\\n    adding user attendance item...\\n    userId: \".concat(userId,\",\\n    selectedUserId: \").concat(userId,\"\\n    attachmentName: \").concat(attachmentName,\",\\n    attachmentFormat: \").concat(attachmentFormat,\",\\n    attachmentPath: \").concat(attachmentPath,\"\\n    \"));_this.setState({userAlert:\"adding user attachment item...\"});var requestBody={query:\"\\n        mutation{updateUserAttachment(userId:\\\"\".concat(userId,\"\\\",selectedUserId:\\\"\").concat(userId,\"\\\",userInput:{attachmentName:\\\"\").concat(attachmentName,\"\\\",attachmentFormat:\\\"\").concat(attachmentFormat,\"\\\",attachmentPath:\\\"\").concat(attachmentPath,\"\\\"})\\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n      \")};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData.data.updateUserAttachment));var updatedUserId=resData.data.updateUserAttachment._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.updateUserAttachment);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});_this.getThisUser();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.modalCancelHandler=function(){_this.setState({updating:false});};_this.deleteUserAttendanceItem=function(props){var token=_this.context.token;var userId=_this.context.userId;var date=new Date(props.date.substr(0,10)*1000).toISOString().slice(0,10);console.log(\"\\n      delete user Attendance item:\\n      props: \".concat(JSON.stringify(props),\",\\n      token: \").concat(token,\",\\n      userId: \").concat(userId,\",\\n      selectedUserId: \").concat(userId,\",\\n      attandance date: \").concat(date,\",\\n      \"));var requestBody={query:\"\\n         mutation{deleteUserAttendance(userId:\\\"\".concat(userId,\"\\\",selectedUserId:\\\"\").concat(userId,\"\\\",attendanceDate:\\\"\").concat(date,\"\\\")\\n         {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}\\n        }\\n       \")};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){// let deletedUser = resData.data.deleteUserAttendance;\nconsole.log(\"resData.data:  \",resData.data.deleteUserAttendance);var updatedUserId=resData.data.deleteUserAttendance._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.deleteUserAttendance);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});// this.setState({ userAlert: responseAlert, selectedUser: resData.data.deleteUserAttendance})\n_this.getThisUser();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.deleteUserLeaveItem=function(props){var token=_this.context.token;var userId=_this.context.userId;console.log(\"\\n      delete user Leave item:\\n      props: \".concat(JSON.stringify(props),\",\\n      token: \").concat(token,\",\\n      userId: \").concat(userId,\",\\n      selectedUserId: \").concat(userId,\",\\n      \"));var requestBody={query:\"\\n         mutation{deleteUserLeave(userId:\\\"\".concat(userId,\"\\\",selectedUserId:\\\"\").concat(userId,\"\\\",leaveTitle:\\\"\").concat(props.title,\"\\\")\\n         {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n      \")};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){// let deletedUser = resData.data.deleteUserLeave;\n// console.log(deletedUser);\nvar updatedUserId=resData.data.deleteUserLeave._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.deleteUserLeave);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});// this.setState({ userAlert: responseAlert, selectedUser: resData.data.deleteUserLeave})\n// this.getThisUser();\n}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.deleteUserAttachmentItem=function(props){var token=_this.context.token;var userId=_this.context.userId;console.log(\"\\n      delete user Attachment item:\\n      props: \".concat(JSON.stringify(props),\",\\n      token: \").concat(token,\",\\n      userId: \").concat(userId,\",\\n      selectedUserId: \").concat(userId,\",\\n      \"));// console.log(`\n//   deleting from s3...\n//   file.name: ${props.name},\n//   `);\n//\n//   const config = {\n//     bucketName: this.context.creds.s3.bucketName,\n//     dirName: props.path,\n//     region: this.context.creds.s3.region,\n//     accessKeyId: this.context.creds.s3.accessKeyId,\n//     secretAccessKey: this.context.creds.s3.secretAccessKey,\n//   }\n// const ReactS3Client = new S3(config);\n// const filename = props.name;\n// // const attachmentName = newFileName;\n// //\n// S3FileUpload\n// .deleteFile(filename, config)\n// .then(response => console.log(response))\n// .catch(err => console.error(err))\nvar requestBody={query:\"\\n         mutation{deleteUserAttachment(userId:\\\"\".concat(userId,\"\\\",selectedUserId:\\\"\").concat(userId,\"\\\",attachmentName:\\\"\").concat(props.name,\"\\\")\\n         {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n      \")};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){// let deletedUser = resData.data.deleteUserAttachment;\n// console.log(deletedUser);\nvar updatedUserId=resData.data.deleteUserAttachment._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.deleteUserAttachment);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});// this.setState({ userAlert: responseAlert, selectedUser: resData.data.deleteUserAttachment})\n_this.getThisUser();}).catch(function(err){console.log(err);});};_this.onViewAttachment=function(attachment){console.log(\"\\n      setting up attachment viewer...\\n      attachment: \".concat(JSON.stringify(attachment),\"\\n      \"));_this.setState({showAttachment:true});var file=\"https://ent-emr-bucket.s3-us-east-2.amazonaws.com/\"+attachment.path+\"/\"+attachment.name+\".\"+attachment.format;var type=attachment.format;_this.setState({showThisAttachmentFile:file,showThisAttachmentType:type});};_this.closeAttachmentView=function(){console.log(\"\\n      closing attachment viewer...\\n      \");_this.setState({showAttachment:false});};_this.createPdf=function(user){console.log(\"\\n        creating pdf...\\n        user: \".concat(JSON.stringify(user),\"\\n      \"));var pdfData={title:user.name,body:user.dob};_this.setState({createPdf:true,pdfData:pdfData});};_this.closePdfCreator=function(){console.log(\"\\n      closing pdf creator...\\n      \");_this.setState({createPdf:false,pdfData:null});};return _this;}_createClass(ThisUserPage,[{key:\"componentDidMount\",// constructor(props) {\n//   super(props);\n// }\nvalue:function componentDidMount(){this.getThisUser();this.getCreds();if(this.context.user.name===\"Lord-of-the-Manor\"){this.setState({canDelete:true});}// if (this.context.user.name === 'admin579'){\n//   this.setState({canDelete: true})\n// }\n}},{key:\"getThisUser\",value:function getThisUser(){var _this2=this;this.setState({isLoading:true});var requestBody={query:\"\\n      query {getThisUser\\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n        \"};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+this.context.token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"resdata...\"+JSON.stringify(resData));var thisUser=resData.data.getThisUser;if(_this2.isActive){_this2.setState({user:thisUser,isLoading:false});_this2.context.user=thisUser;console.log(\"this.context.user:  \"+_this2.context.user.name);sessionStorage.setItem('thisUser',JSON.stringify(thisUser));}}).catch(function(err){console.log(err);_this2.setState({userAlert:err});if(_this2.isActive){_this2.setState({isLoading:false});}});}},{key:\"getCreds\",value:function getCreds(){var _this3=this;this.setState({isLoading:true});var requestBody={query:\"\\n      query {getCreds\\n        {atlas{user,pw,db},s3{bucketName,region,accessKeyId,secretAccessKey},jwt{encode}}}\\n        \"};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+this.context.token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){// console.log(\"resdata...\" + JSON.stringify(resData));\nvar creds=resData.data.getCreds;if(_this3.isActive){_this3.setState({isLoading:false});_this3.context.creds=creds;}}).catch(function(err){console.log(err);_this3.setState({userAlert:err});if(_this3.isActive){_this3.setState({isLoading:false});}});}},{key:\"updateUserSpecialProfile\",value:function updateUserSpecialProfile(event){console.log(\"special field to update:  \",event.target.value);var field=event.target.value;this.setState({userUpdateField:field});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.isActive=false;}},{key:\"render\",value:function render(){return React.createElement(React.Fragment,null,this.state.showAttachment===true&&React.createElement(AttachmentViewer,{onCloseAttachmentView:this.closeAttachmentView,attachmentFile:this.state.showThisAttachmentFile,attachmentType:this.state.showThisAttachmentType}),this.state.createPdf===true&&React.createElement(PdfCreator,{pdfData:this.state.pdfData,onClosePdfCreator:this.closePdfCreator}),React.createElement(Row,null,React.createElement(Col,{md:3,className:\"MasterCol1\"},React.createElement(AlertBox,{authUserId:this.context.userId,alert:this.state.userAlert}),React.createElement(SidebarPage,{you:this.state.user})),React.createElement(Col,{md:9,className:\"MasterCol2\"},React.createElement(Container,{className:\"containerProfile\"},React.createElement(Tab.Container,{id:\"left-tabs-example\",defaultActiveKey:\"Detail\"},React.createElement(Row,null,React.createElement(Col,{sm:2},React.createElement(Nav,{variant:\"pills\",className:\"flex-column\"},React.createElement(Nav.Item,null,React.createElement(Nav.Link,{eventKey:\"Detail\"},\"You\")),React.createElement(Nav.Item,null,React.createElement(Nav.Link,{eventKey:\"disabled\",disabled:true},\"Edit:\")),React.createElement(Nav.Item,null,React.createElement(Nav.Link,{eventKey:\"Demographics\"},\"Demographics\")),React.createElement(Nav.Item,null,React.createElement(Nav.Link,{eventKey:\"userEditField\"},\"Single Field\")),React.createElement(Nav.Item,null,React.createElement(Nav.Link,{eventKey:\"disabled\",disabled:true},\"Add:\")),React.createElement(Nav.Item,null,React.createElement(Nav.Link,{eventKey:\"Attandance\"},\"Attendance\")),React.createElement(Nav.Item,null,React.createElement(Nav.Link,{eventKey:\"Attachment\"},\"Attachment\")),React.createElement(Nav.Item,null,React.createElement(Nav.Link,{eventKey:\"Leave\"},\"Leave\")))),React.createElement(Col,{sm:10},React.createElement(Tab.Content,null,React.createElement(Tab.Pane,{eventKey:\"Detail\"},this.state.user!==null&&React.createElement(ThisUserProfile,{user:this.state.user,authUserId:this.context.userId,canDelete:this.state.canDelete,attendanceDelete:this.deleteUserAttendanceItem,leaveDelete:this.deleteUserLeaveItem,attachmentDelete:this.deleteUserAttachmentItem,onViewAttachment:this.onViewAttachment,onCreatePdf:this.createPdf})),React.createElement(Tab.Pane,{eventKey:\"Demographics\"},React.createElement(Button,{variant:\"outline-primary\",size:\"lg\",className:\"confirmEditButton\",onClick:this.startUpdateUserHandler},\"Edit Demographics\"),this.state.updating===true&&React.createElement(UpdateUserForm,{canCancelProfile:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.modalConfirmUpdateHandler,confirmText:\"Confirm\",user:this.state.user,authUserId:this.context.userId})),React.createElement(Tab.Pane,{eventKey:\"userEditField\"},this.state.selectedUser===null&&React.createElement(Button,{variant:\"outline-warning\",size:\"lg\",className:\"confirmEditButton\"},\"Select a Staff member from the Master List\"),this.state.selectedUser!==null&&React.createElement(Button,{variant:\"outline-primary\",size:\"lg\",className:\"confirmEditButton\",onClick:this.startUpdateUserHandler},\"Edit a Single Field\"),this.state.updating&&this.state.selectedUser!==null&&React.createElement(UpdateUserFieldForm,{authUserId:this.context.userId,canCancel:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.modalConfirmUpdateFieldHandler,confirmText:\"Confirm\",user:this.state.selectedUser})),React.createElement(Tab.Pane,{eventKey:\"Attandance\"},React.createElement(Button,{variant:\"outline-primary\",size:\"lg\",className:\"confirmEditButton\",value:\"attendance\",onClick:this.updateUserSpecialProfile.bind(this)},\"Add Attendance\"),this.state.userUpdateField==='attendance'&&React.createElement(UpdateUserAttendanceForm,{authUserId:this.context.userId,canCancelProfile:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.updateUserAttendanceHandler,confirmText:\"Confirm\",user:this.state.selectedUser})),React.createElement(Tab.Pane,{eventKey:\"Attachment\"},React.createElement(Button,{variant:\"outline-primary\",size:\"lg\",className:\"confirmEditButton\",value:\"attachments\",onClick:this.updateUserSpecialProfile.bind(this)},\"Add Attachment\"),this.state.userUpdateField==='attachments'&&React.createElement(UpdateUserAttachmentForm,{authUserId:this.context.userId,canCancelProfile:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.updateUserAttachmentHandler,confirmText:\"Confirm\",user:this.state.selectedUser})),React.createElement(Tab.Pane,{eventKey:\"Leave\"},React.createElement(Button,{variant:\"outline-primary\",size:\"lg\",className:\"confirmEditButton\",value:\"leave\",onClick:this.updateUserSpecialProfile.bind(this)},\"Add Leave\"),this.state.userUpdateField==='leave'&&React.createElement(UpdateUserLeaveForm,{authUserId:this.context.userId,canCancelProfile:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.updateUserLeaveHandler,confirmText:\"Confirm\",user:this.state.selectedUser}))))))))));}}]);return ThisUserPage;}(Component);ThisUserPage.contextType=AuthContext;export default ThisUserPage;","map":{"version":3,"sources":["/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/src/pages/thisUser.js"],"names":["S3","React","Component","UpdateUserForm","Container","Row","Col","Button","SidebarPage","Tabs","Tab","Nav","AlertBox","AttachmentViewer","PdfCreator","UpdateUserFieldForm","UpdateUserAttendanceForm","UpdateUserAttachmentForm","UpdateUserLeaveForm","ThisUserProfile","AuthContext","ThisUserPage","state","user","users","updating","isLoading","userUpdateField","userAlert","canDelete","showAttachment","createPdf","pdfData","showThisAttachmentFile","showThisAttachmentType","isActive","startUpdateUserHandler","setState","console","log","modalConfirmUpdateHandler","event","token","context","userId","selectedUserId","selectedUser","_id","role","target","formGridEmail","value","email","password","formGridPassword","name","formGridName","dob","formGridDob","phone","formGridPhone","addressNumber","formGridAddressNumber","addressStreet","formGridAddressStreet","addressTown","formGridAddressTown","addressParish","formGridAddressParish","addressPostOffice","formGridAddressPostOffice","employmentDate","formGridEmploymentDate","formGridEmploymentDateTodayCheckbox","checked","Date","toISOString","slice","terminationDate","formGridTerminationDate","formGridTerminationDateTodayCheckbox","trim","length","address","number","street","town","parish","postOffice","requestBody","query","fetch","method","body","JSON","stringify","headers","Authorization","then","res","status","Error","json","resData","updatedUser","data","updateUser","push","responseAlert","getThisUser","catch","err","modalConfirmUpdateFieldHandler","formGridField","field","formGridQuery","updateUserField","updatedUserId","find","e","updatedUserPos","indexOf","slicedArray","splice","updateUserAttendanceHandler","formGridAttendanceStatus","attendanceDate","formGridAttendanceDate","formGridAttendanceDateTodayCheckbox","attendanceStatus","attendanceDescription","formGridAttendanceDescription","updateUserAttendance","updateUserLeaveHandler","formGridLeaveType","leaveType","leaveTitle","formGridLeaveTitle","leaveStartDate","formGridLeaveStartDate","formGridLeaveStartDateTodayCheckbox","leaveEndDate","formGridLeaveEndDate","formGridLeaveEndDateTodayCheckbox","updateUserLeave","updateUserAttachmentHandler","attachmentFormat","formGridAttachmentFormat","attachmentPath","file","_currentValue","config","bucketName","creds","s3","dirName","region","accessKeyId","secretAccessKey","ReactS3Client","newFileName","attachmentName","uploadFile","error","userAttachment","updateUserAttachment","modalCancelHandler","deleteUserAttendanceItem","props","date","substr","deleteUserAttendance","deleteUserLeaveItem","title","deleteUserLeave","deleteUserAttachmentItem","deleteUserAttachment","onViewAttachment","attachment","path","format","type","closeAttachmentView","closePdfCreator","getCreds","thisUser","sessionStorage","setItem","updateUserSpecialProfile","bind","contextType"],"mappings":"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","sourcesContent":["import S3 from 'react-aws-s3';\n// import S3FileUpload from 'react-s3';\nimport React, { Component } from 'react';\nimport UpdateUserForm from '../components/Forms/UpdateUserForm';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\nimport Button from 'react-bootstrap/Button';\nimport SidebarPage from './Sidebar';\nimport Tabs from 'react-bootstrap/Tabs';\nimport Tab from 'react-bootstrap/Tab';\n\n\n\nimport Nav from 'react-bootstrap/Nav';\n\nimport AlertBox from '../components/AlertBox';\nimport AttachmentViewer from '../components/AttachmentViewer';\nimport PdfCreator from '../components/PdfCreator';\n\nimport UpdateUserFieldForm from '../components/Forms/UpdateUserFieldForm';\nimport UpdateUserAttendanceForm from '../components/Forms/UpdateUserAttendanceForm';\nimport UpdateUserAttachmentForm from '../components/Forms/UpdateUserAttachmentForm';\nimport UpdateUserLeaveForm from '../components/Forms/UpdateUserLeaveForm';\n\nimport ThisUserProfile from '../components/Users/thisUserProfile';\n\nimport AuthContext from '../context/auth-context';\nimport './Users.css';\n\nclass ThisUserPage extends Component {\n  state = {\n    user: null,\n    users: [],\n    updating: false,\n    isLoading: false,\n    userUpdateField: null,\n    userAlert: null,\n    canDelete: null,\n    showAttachment: false,\n    createPdf: false,\n    pdfData: null,\n    showThisAttachmentFile: null,\n    showThisAttachmentType: null,\n  };\n  isActive = true;\n\n  static contextType = AuthContext;\n\n  // constructor(props) {\n  //   super(props);\n  // }\n\n  componentDidMount() {\n    this.getThisUser();\n    this.getCreds();\n    if (this.context.user.name === \"Lord-of-the-Manor\"){\n      this.setState({canDelete: true})\n    }\n    // if (this.context.user.name === 'admin579'){\n    //   this.setState({canDelete: true})\n    // }\n  }\n\n  startUpdateUserHandler = () => {\n    this.setState({ updating: true });\n    console.log(\"UpdateUserForm...\");\n  };\n\n\n  modalConfirmUpdateHandler = (event) => {\n    const token = this.context.token;\n    let userId = this.context.userId;\n    let selectedUserId = this.context.selectedUser._id;\n    if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n      console.log(\"Not the creator or Admin! No edit permission!!\");\n      this.setState({userAlert: \"Not the creator or Admin! No edit permission!!\"});\n      selectedUserId = null;\n    }\n    console.log(\"UpdateUserFormData:  \", event.target.formGridEmail.value);\n    this.setState({ updating: false });\n    let email = event.target.formGridEmail.value;\n    let password = event.target.formGridPassword.value;\n    let name = event.target.formGridName.value;\n    let role = this.context.user.role;\n    let dob = event.target.formGridDob.value;\n    let phone = event.target.formGridPhone.value;\n    let addressNumber = event.target.formGridAddressNumber.value;\n    let addressStreet = event.target.formGridAddressStreet.value;\n    let addressTown = event.target.formGridAddressTown.value;\n    let addressParish = event.target.formGridAddressParish.value;\n    let addressPostOffice = event.target.formGridAddressPostOffice.value;\n\n    let employmentDate = event.target.formGridEmploymentDate.value;\n    if (event.target.formGridEmploymentDateTodayCheckbox.checked === true) {\n      employmentDate = new Date().toISOString().slice(0,10);\n    }\n\n    let terminationDate = event.target.formGridTerminationDate.value;\n    if (event.target.formGridTerminationDateTodayCheckbox.checked === true) {\n      terminationDate = new Date().toISOString().slice(0,10);\n    }\n\n    if (email.trim().length === 0 ) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      email = this.context.user.email;\n    }\n    if (password.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      password = this.context.user.password;\n    }\n    if (name.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      name = this.context.user.name;\n    }\n    // if (role.trim().length === 0) {\n    //   console.log(\"blank fields detected!!!...filling w/ previous data...\");\n    //   role = this.state.user.role;\n    // }\n    if (dob.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      dob = this.context.user.dob;\n    }\n    if (phone.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      phone = this.context.user.phone;\n    }\n    if (addressNumber.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressNumber = this.context.user.address.number;\n    }\n    if (addressStreet.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressStreet = this.context.user.address.street;\n    }\n    if (addressTown.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressTown = this.context.user.address.town;\n    }\n    if (addressParish.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressParish = this.context.user.address.parish;\n    }\n    if (addressPostOffice.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressPostOffice = this.context.user.address.postOffice;\n    }\n    if (employmentDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      employmentDate = this.context.user.employmentDate;\n    }\n    if (terminationDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      terminationDate = this.context.user.terminationDate;\n    }\n\n\n    console.log(`\n      updating user profile...\n      userId: ${userId}\n      email: ${email},\n      password: ${password},\n      name: ${name},\n      role: ${role},\n      dob: ${dob},\n      phone: ${phone},\n      addressNumber: ${addressNumber},\n      addressStreet: ${addressStreet},\n      addressTown: ${addressTown},\n      addressParish: ${addressParish},\n      addressPostOffice: ${addressPostOffice},\n      employmentDate: ${employmentDate},\n      terminationDate: ${terminationDate},\n      `);\n\n    const requestBody = {\n      query: `\n        mutation {updateUser(userId:\"${userId}\",selectedUserId:\"${userId}\",userInput: {email:\"${email}\",password:\"${password}\",name:\"${name}\",dob:\"${dob}\",addressNumber:${addressNumber},addressStreet:\"${addressStreet}\",addressTown:\"${addressTown}\",addressParish:\"${addressParish}\", addressPostOffice:\"${addressPostOffice}\",phone:\"${phone}\",role:\"${role}\",employmentDate:\"${employmentDate}\",terminationDate:\"${terminationDate}\"})\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n        `};\n\n    fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n    // fetch('http://localhost:10000/graphql', {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + token\n      }})\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error('Failed!');\n        }\n        return res.json();\n      })\n      .then(resData => {\n        console.log(\"response data... \" + JSON.stringify(resData));\n\n        const updatedUser = resData.data.updateUser;\n        console.log(\"updatedUser:  \", JSON.stringify(updatedUser));\n        this.state.users.push(updatedUser);\n        this.context.users = this.state.users;\n\n        const responseAlert = JSON.stringify(resData.data).slice(2,25);\n        this.setState({ userAlert: responseAlert, user: updatedUser})\n        this.getThisUser();\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({userAlert: err});\n      });\n    };\n\n    modalConfirmUpdateFieldHandler = (event) => {\n\n      const token = this.context.token;\n      const userId = this.context.userId;\n      let selectedUserId = this.context.selectedUser._id;\n      if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n        console.log(\"Not the creator or Admin! No edit permission!!\");\n        this.setState({userAlert: \"Not the creator or Admin! No edit permission!!\"});\n        selectedUserId = null;\n      }\n\n        console.log(\"UpdateUserFieldFormData:  \", event.target.formGridField.value);\n        this.setState({ updating: false });\n\n        let field = event.target.formGridField.value;\n        let query = event.target.formGridQuery.value;\n\n        const requestBody = {\n          query:`\n            mutation{updateUserField(userId:\"${userId}\",selectedUserId:\"${userId}\",field:\"${field}\",query:\"${query}\")\n            {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n          `};\n\n        fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n        // fetch('http://localhost:10000/graphql', {\n          method: 'POST',\n          body: JSON.stringify(requestBody),\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: 'Bearer ' + token\n          }\n        })\n          .then(res => {\n            if (res.status !== 200 && res.status !== 201) {\n              throw new Error('Failed!');\n            }\n            return res.json();\n          })\n          .then(resData => {\n            console.log(\"response data... \" + JSON.stringify(resData.data.updateUserField));\n\n            const updatedUserId = resData.data.updateUserField._id;\n            const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n            const updatedUserPos = this.state.users.indexOf(updatedUser);\n            const slicedArray = this.state.users.splice(updatedUserPos, 1);\n            console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n\n            this.state.users.push(resData.data.updateUserField);\n            this.context.users = this.state.users;\n            const responseAlert = JSON.stringify(resData.data).slice(2,25);\n            this.setState({ userAlert: responseAlert})\n            this.getThisUser();\n          })\n          .catch(err => {\n            console.log(err);\n            this.setState({userAlert: err});\n          });\n\n    }\n\n  updateUserAttendanceHandler = (event) => {\n    const token = this.context.token;\n    const userId = this.state.user._id;\n    // let selectedUserId = this.context.selectedUser._id;\n    // if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n    //   console.log(\"Not the creator or Admin! No edit permission!!\");\n    //   selectedUserId = null;\n    // }\n    console.log(\"UpdateUserAttendanceFormData:  \", event.target.formGridAttendanceStatus.value);\n\n    this.setState({ updating: false , userUpdateField: null });\n\n    let attendanceDate = event.target.formGridAttendanceDate.value;\n    if (event.target.formGridAttendanceDateTodayCheckbox.checked === true) {\n      attendanceDate = new Date().toISOString().slice(0,10);\n    }\n\n    let attendanceStatus = event.target.formGridAttendanceStatus.value;\n    let attendanceDescription = event.target.formGridAttendanceDescription.value;\n\n    if (attendanceDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      attendanceDate = this.context.selectedUser.attendanceDate;\n    }\n    if (attendanceStatus.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      attendanceStatus = this.context.selectedUser.attendanceStatus;\n    }\n    if (attendanceDescription.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      attendanceDescription = this.context.selectedUser.attendanceDescription;\n    }\n\n\n    console.log(`\n      adding user attendance item...\n      userId: ${userId},\n      attendanceDate: ${attendanceDate},\n      attendanceStatus: ${attendanceStatus},\n      attendanceDescription: ${attendanceDescription}\n      `);\n\n      const requestBody = {\n        query:`\n          mutation {updateUserAttendance(userId:\"${userId}\", selectedUserId:\"${userId}\",userInput:{attendanceDate:\"${attendanceDate}\",attendanceStatus:\"${attendanceStatus}\",attendanceDescription:\"${attendanceDescription}\"})\n          {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n        `};\n\n      fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n      // fetch('http://localhost:10000/graphql', {\n        method: 'POST',\n        body: JSON.stringify(requestBody),\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer ' + token\n        }})\n        .then(res => {\n          if (res.status !== 200 && res.status !== 201) {\n            throw new Error('Failed!');\n          }\n          return res.json();\n        })\n        .then(resData => {\n          console.log(\"response data... \" + JSON.stringify(resData.data.updateUserAttendance));\n\n          const updatedUserId = resData.data.updateUserAttendance._id;\n          const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n          const updatedUserPos = this.state.users.indexOf(updatedUser);\n          const slicedArray = this.state.users.splice(updatedUserPos, 1);\n          console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n          this.state.users.push(resData.data.updateUserAttendance);\n          this.context.users = this.state.users;\n          const responseAlert = JSON.stringify(resData.data).slice(2,25);\n          this.setState({ userAlert: responseAlert})\n          this.getThisUser();\n\n        })\n        .catch(err => {\n          console.log(err);\n          this.setState({userAlert: err});\n        });\n  };\n\n\n  updateUserLeaveHandler = (event) => {\n    const token = this.context.token;\n    const userId = this.context.userId;\n    let selectedUserId = this.context.selectedUser._id;\n    if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n      console.log(\"Not the creator or Admin! No edit permission!!\");\n      this.setState({userAlert: \"Not the creator or Admin! No edit permission!!\"});\n      selectedUserId = null;\n    }\n\n    console.log(\"UpdateUserLeaveFormData:  \", event.target.formGridLeaveType.value);\n\n    this.setState({ updating: false , userUpdateField: null });\n\n    let leaveType = event.target.formGridLeaveType.value;\n    let leaveTitle = event.target.formGridLeaveTitle.value;\n\n    let leaveStartDate = event.target.formGridLeaveStartDate.value;\n    if (event.target.formGridLeaveStartDateTodayCheckbox.checked === true) {\n      leaveStartDate = new Date().toISOString().slice(0,10);\n    }\n\n    let leaveEndDate = event.target.formGridLeaveEndDate.value;\n    if (event.target.formGridLeaveEndDateTodayCheckbox.checked === true) {\n      leaveEndDate = new Date().toISOString().slice(0,10);\n    }\n\n    if (leaveType.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      leaveType = this.context.selectedUser.leaveType;\n    }\n    if (leaveTitle.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      leaveTitle = this.context.selectedUser.leaveTitle;\n    }\n    if (leaveStartDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      leaveStartDate = this.context.selectedUser.leaveStartDate;\n    }\n    if (leaveEndDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      leaveEndDate = this.context.selectedUser.leaveEndDate;\n    }\n\n\n    console.log(`\n      adding user attendance item...\n      userId: ${userId},\n      selectedUserId: ${selectedUserId}\n      leave: {\n        type: ${leaveType},\n        title: ${leaveTitle},\n        startDate: ${leaveStartDate},\n        endDate: ${leaveEndDate}\n      }\n      `);\n\n      const requestBody = {\n        query:`\n          mutation {updateUserLeave(userId:\"${userId}\", selectedUserId:\"${userId}\",userInput:{leaveType:\"${leaveType}\",leaveTitle:\"${leaveTitle}\",leaveStartDate:\"${leaveStartDate}\",leaveEndDate:\"${leaveEndDate}\"})\n          {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n        `};\n\n      fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n      // fetch('http://localhost:10000/graphql', {\n        method: 'POST',\n        body: JSON.stringify(requestBody),\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer ' + token\n        }})\n        .then(res => {\n          if (res.status !== 200 && res.status !== 201) {\n            throw new Error('Failed!');\n          }\n          return res.json();\n        })\n        .then(resData => {\n          console.log(\"response data... \" + JSON.stringify(resData.data));\n\n          const updatedUserId = resData.data.updateUserLeave._id;\n          const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n          const updatedUserPos = this.state.users.indexOf(updatedUser);\n          const slicedArray = this.state.users.splice(updatedUserPos, 1);\n          console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n\n          this.state.users.push(resData.data.updateUserLeave);\n          this.context.users = this.state.users;\n          const responseAlert = JSON.stringify(resData.data).slice(2,25);\n          this.setState({ userAlert: responseAlert})\n          this.getThisUser();\n\n        })\n        .catch(err => {\n          console.log(err);\n          this.setState({userAlert: err});\n        });\n  };\n\n\n  updateUserAttachmentHandler = (event) => {\n\n  const token = this.context.token;\n  const userId = this.context.userId;\n  // let selectedUserId = this.context.selectedUser._id;\n  // if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n  //   console.log(\"Not the creator or Admin! No edit permission!!\");\n  //   selectedUserId = null;\n  // }\n  // if (userId !== selectedUserId && this.context.user.role !== \"admin\" ) {\n  //   console.log(\"Not the creator or Admin! No edit permission!!\");\n  //   this.setState({userAlert: \"Not the creator or Admin! No edit permission!!\"})\n  //     selectedUserId = null;\n  // }\n\n  console.log(\"UpdateUserAttachmentFormData:  \");\n\n  this.setState({ updating: false , userUpdateField: null });\n\n  // let attachmentName = event.target.formGridAttachmentName.value;\n  let attachmentFormat = event.target.formGridAttachmentFormat.value;\n  let attachmentPath = \"uploads/staff/\"+userId+\"/attachments\";\n  // let attachmentPath = event.target.formGridAttachmentPath.value;\n  let file = AuthContext._currentValue.file;\n\n  console.log(`\n    uploading to s3...\n    file.name: ${file.name},\n    AuthContext._currentValue.file: ${AuthContext._currentValue.file},\n    `);\n    const config = {\n      bucketName: this.context.creds.s3.bucketName,\n      dirName: attachmentPath,\n      region: this.context.creds.s3.region,\n      accessKeyId: this.context.creds.s3.accessKeyId,\n      secretAccessKey: this.context.creds.s3.secretAccessKey,\n    }\n  const ReactS3Client = new S3(config);\n  const newFileName = file.name;\n  const attachmentName = newFileName;\n\n  ReactS3Client\n      .uploadFile(file, newFileName)\n      .then(data => {console.log(data);this.setState({userAlert: \"attachment upload success!\"});})\n      .catch(err => {console.error(err);this.setState({userAlert: \"upload error:  \"+err});})\n\n\n  if (\n    attachmentName.trim().length === 0 ||\n    attachmentFormat.trim().length === 0 ||\n    attachmentPath.trim().length === 0\n) {\n    console.log(\"blank fields detected!!! try again\");\n    return\n  }\n\n  const userAttachment = { attachmentName, attachmentFormat, attachmentPath }\n  console.log(`\n    adding user attendance item...\n    userId: ${userId},\n    selectedUserId: ${userId}\n    attachmentName: ${attachmentName},\n    attachmentFormat: ${attachmentFormat},\n    attachmentPath: ${attachmentPath}\n    `);\n    this.setState({userAlert: \"adding user attachment item...\"})\n\n    const requestBody = {\n      query:`\n        mutation{updateUserAttachment(userId:\"${userId}\",selectedUserId:\"${userId}\",userInput:{attachmentName:\"${attachmentName}\",attachmentFormat:\"${attachmentFormat}\",attachmentPath:\"${attachmentPath}\"})\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n      `};\n\n    fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n    // fetch('http://localhost:10000/graphql', {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + token\n      }\n    })\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error('Failed!');\n        }\n        return res.json();\n      })\n      .then(resData => {\n        console.log(\"response data... \" + JSON.stringify(resData.data.updateUserAttachment));\n\n        const updatedUserId = resData.data.updateUserAttachment._id;\n        const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n        const updatedUserPos = this.state.users.indexOf(updatedUser);\n        const slicedArray = this.state.users.splice(updatedUserPos, 1);\n        console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n\n        this.state.users.push(resData.data.updateUserAttachment);\n        this.context.users = this.state.users;\n        const responseAlert = JSON.stringify(resData.data).slice(2,25);\n        this.setState({ userAlert: responseAlert})\n        this.getThisUser();\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({userAlert: err});\n      });\n\n\n}\n\n\n  getThisUser() {\n    this.setState({ isLoading: true });\n    const requestBody = {\n      query: `\n      query {getThisUser\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n        `};\n\n    fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n    // fetch('http://localhost:10000/graphql', {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + this.context.token\n      }})\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error('Failed!');\n        }\n        return res.json();\n      })\n      .then(resData => {\n        console.log(\"resdata...\" + JSON.stringify(resData));\n        const thisUser = resData.data.getThisUser;\n        if (this.isActive) {\n\n          this.setState({ user: thisUser, isLoading: false });\n\n          this.context.user = thisUser;\n          console.log(\"this.context.user:  \" + this.context.user.name);\n\n          sessionStorage.setItem('thisUser', JSON.stringify(thisUser));\n        }\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({userAlert: err});\n        if (this.isActive) {\n          this.setState({ isLoading: false });\n        }\n      });\n  }\n\n  getCreds() {\n    this.setState({ isLoading: true });\n    const requestBody = {\n      query: `\n      query {getCreds\n        {atlas{user,pw,db},s3{bucketName,region,accessKeyId,secretAccessKey},jwt{encode}}}\n        `};\n\n    fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n    // fetch('http://localhost:10000/graphql', {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + this.context.token\n      }})\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error('Failed!');\n        }\n        return res.json();\n      })\n      .then(resData => {\n        // console.log(\"resdata...\" + JSON.stringify(resData));\n        const creds = resData.data.getCreds;\n        if (this.isActive) {\n\n          this.setState({ isLoading: false });\n\n          this.context.creds = creds;\n        }\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({userAlert: err});\n        if (this.isActive) {\n          this.setState({ isLoading: false });\n        }\n      });\n  }\n\n\n  modalCancelHandler = () => {\n    this.setState({ updating: false  });\n  };\n\n\n  deleteUserAttendanceItem = (props) => {\n\n    let token = this.context.token;\n    let userId = this.context.userId;\n    let date = new Date(props.date.substr(0,10)*1000).toISOString().slice(0,10);\n\n    console.log(`\n      delete user Attendance item:\n      props: ${JSON.stringify(props)},\n      token: ${token},\n      userId: ${userId},\n      selectedUserId: ${userId},\n      attandance date: ${date},\n      `);\n\n      const requestBody = {\n        query:`\n         mutation{deleteUserAttendance(userId:\"${userId}\",selectedUserId:\"${userId}\",attendanceDate:\"${date}\")\n         {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}\n        }\n       `};\n\n          fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n          // fetch('http://localhost:10000/graphql', {\n            method: 'POST',\n            body: JSON.stringify(requestBody),\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: 'Bearer ' + token\n            }\n          })\n            .then(res => {\n              if (res.status !== 200 && res.status !== 201) {\n                throw new Error('Failed!');\n              }\n              return res.json();\n            })\n            .then(resData => {\n              // let deletedUser = resData.data.deleteUserAttendance;\n              console.log(\"resData.data:  \",resData.data.deleteUserAttendance);\n\n              const updatedUserId = resData.data.deleteUserAttendance._id;\n              const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n              const updatedUserPos = this.state.users.indexOf(updatedUser);\n              const slicedArray = this.state.users.splice(updatedUserPos, 1);\n              console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n\n              this.state.users.push(resData.data.deleteUserAttendance);\n              this.context.users = this.state.users;\n              const responseAlert = JSON.stringify(resData.data).slice(2,25);\n              this.setState({ userAlert: responseAlert})\n              // this.setState({ userAlert: responseAlert, selectedUser: resData.data.deleteUserAttendance})\n              this.getThisUser();\n\n\n            })\n            .catch(err => {\n              console.log(err);\n              this.setState({userAlert: err});\n            });\n  }\n\n  deleteUserLeaveItem = (props) => {\n\n    let token = this.context.token;\n    let userId = this.context.userId;\n\n    console.log(`\n      delete user Leave item:\n      props: ${JSON.stringify(props)},\n      token: ${token},\n      userId: ${userId},\n      selectedUserId: ${userId},\n      `);\n\n      const requestBody = {\n        query:`\n         mutation{deleteUserLeave(userId:\"${userId}\",selectedUserId:\"${userId}\",leaveTitle:\"${props.title}\")\n         {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n      `};\n\n          fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n          // fetch('http://localhost:10000/graphql', {\n            method: 'POST',\n            body: JSON.stringify(requestBody),\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: 'Bearer ' + token\n            }\n          })\n            .then(res => {\n              if (res.status !== 200 && res.status !== 201) {\n                throw new Error('Failed!');\n              }\n              return res.json();\n            })\n            .then(resData => {\n              // let deletedUser = resData.data.deleteUserLeave;\n              // console.log(deletedUser);\n\n              const updatedUserId = resData.data.deleteUserLeave._id;\n              const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n              const updatedUserPos = this.state.users.indexOf(updatedUser);\n              const slicedArray = this.state.users.splice(updatedUserPos, 1);\n              console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n\n              this.state.users.push(resData.data.deleteUserLeave);\n              this.context.users = this.state.users;\n              const responseAlert = JSON.stringify(resData.data).slice(2,25);\n              this.setState({ userAlert: responseAlert})\n              // this.setState({ userAlert: responseAlert, selectedUser: resData.data.deleteUserLeave})\n              // this.getThisUser();\n\n\n            })\n            .catch(err => {\n              console.log(err);\n              this.setState({userAlert: err});\n            });\n  }\n\n  deleteUserAttachmentItem = (props) => {\n\n    let token = this.context.token;\n    let userId = this.context.userId;\n\n    console.log(`\n      delete user Attachment item:\n      props: ${JSON.stringify(props)},\n      token: ${token},\n      userId: ${userId},\n      selectedUserId: ${userId},\n      `);\n\n      // console.log(`\n      //   deleting from s3...\n      //   file.name: ${props.name},\n      //   `);\n      //\n      //   const config = {\n      //     bucketName: this.context.creds.s3.bucketName,\n      //     dirName: props.path,\n      //     region: this.context.creds.s3.region,\n      //     accessKeyId: this.context.creds.s3.accessKeyId,\n      //     secretAccessKey: this.context.creds.s3.secretAccessKey,\n      //   }\n      // const ReactS3Client = new S3(config);\n      // const filename = props.name;\n      // // const attachmentName = newFileName;\n      // //\n      // S3FileUpload\n      // .deleteFile(filename, config)\n      // .then(response => console.log(response))\n      // .catch(err => console.error(err))\n\n\n      const requestBody = {\n        query:`\n         mutation{deleteUserAttachment(userId:\"${userId}\",selectedUserId:\"${userId}\",attachmentName:\"${props.name}\")\n         {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n      `};\n\n          fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n          // fetch('http://localhost:10000/graphql', {\n            method: 'POST',\n            body: JSON.stringify(requestBody),\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: 'Bearer ' + token\n            }\n          })\n            .then(res => {\n              if (res.status !== 200 && res.status !== 201) {\n                throw new Error('Failed!');\n              }\n              return res.json();\n            })\n            .then(resData => {\n              // let deletedUser = resData.data.deleteUserAttachment;\n              // console.log(deletedUser);\n\n              const updatedUserId = resData.data.deleteUserAttachment._id;\n              const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n              const updatedUserPos = this.state.users.indexOf(updatedUser);\n              const slicedArray = this.state.users.splice(updatedUserPos, 1);\n              console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n\n              this.state.users.push(resData.data.deleteUserAttachment);\n              this.context.users = this.state.users;\n              const responseAlert = JSON.stringify(resData.data).slice(2,25);\n              this.setState({ userAlert: responseAlert})\n              // this.setState({ userAlert: responseAlert, selectedUser: resData.data.deleteUserAttachment})\n              this.getThisUser();\n\n            })\n            .catch(err => {\n              console.log(err);\n            });\n  }\n\n\n  updateUserSpecialProfile (event) {\n    console.log(\"special field to update:  \", event.target.value);\n    const field = event.target.value;\n    this.setState({ userUpdateField: field});\n  }\n\n  onViewAttachment = (attachment) => {\n    console.log(`\n      setting up attachment viewer...\n      attachment: ${JSON.stringify(attachment)}\n      `);\n      this.setState({showAttachment: true})\n\n      const file = \"https://ent-emr-bucket.s3-us-east-2.amazonaws.com/\"+attachment.path+\"/\"+attachment.name+\".\"+attachment.format;\n      const type = attachment.format;\n\n      this.setState({showThisAttachmentFile: file, showThisAttachmentType: type})\n  }\n\n  closeAttachmentView = () => {\n    console.log(`\n      closing attachment viewer...\n      `);\n      this.setState({showAttachment: false})\n  }\n\n  createPdf = (user) => {\n    console.log(`\n        creating pdf...\n        user: ${JSON.stringify(user)}\n      `);\n\n      const pdfData = {\n        title: user.name,\n        body: user.dob,\n      };\n\n    this.setState({createPdf: true, pdfData: pdfData})\n  }\n\n  closePdfCreator = () => {\n    console.log(`\n      closing pdf creator...\n      `);\n      this.setState({createPdf: false, pdfData: null})\n  }\n\n\n\n  componentWillUnmount() {\n    this.isActive = false;\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n\n      {this.state.showAttachment === true && (\n        <AttachmentViewer\n          onCloseAttachmentView={this.closeAttachmentView}\n          attachmentFile={this.state.showThisAttachmentFile}\n          attachmentType={this.state.showThisAttachmentType}\n        />\n      )}\n\n      {this.state.createPdf === true && (\n          <PdfCreator\n            pdfData={this.state.pdfData}\n            onClosePdfCreator={this.closePdfCreator}\n          />\n      )}\n\n      <Row>\n      <Col md={3} className=\"MasterCol1\">\n      <AlertBox\n        authUserId={this.context.userId}\n        alert={this.state.userAlert}\n      />\n      <SidebarPage\n        you={this.state.user}\n      />\n      </Col>\n\n      <Col md={9} className=\"MasterCol2\">\n        <Container className=\"containerProfile\">\n\n        <Tab.Container id=\"left-tabs-example\" defaultActiveKey=\"Detail\">\n          <Row>\n            <Col sm={2}>\n              <Nav variant=\"pills\" className=\"flex-column\">\n                <Nav.Item>\n                  <Nav.Link eventKey=\"Detail\">You</Nav.Link>\n                </Nav.Item>\n                <Nav.Item>\n                  <Nav.Link eventKey=\"disabled\" disabled>Edit:</Nav.Link>\n                </Nav.Item>\n                <Nav.Item>\n                  <Nav.Link eventKey=\"Demographics\">Demographics</Nav.Link>\n                </Nav.Item>\n                <Nav.Item>\n                  <Nav.Link eventKey=\"userEditField\">Single Field</Nav.Link>\n                </Nav.Item>\n                <Nav.Item>\n                  <Nav.Link eventKey=\"disabled\" disabled>Add:</Nav.Link>\n                </Nav.Item>\n                <Nav.Item>\n                  <Nav.Link eventKey=\"Attandance\">Attendance</Nav.Link>\n                </Nav.Item>\n                <Nav.Item>\n                  <Nav.Link eventKey=\"Attachment\">Attachment</Nav.Link>\n                </Nav.Item>\n                <Nav.Item>\n                  <Nav.Link eventKey=\"Leave\">Leave</Nav.Link>\n                </Nav.Item>\n              </Nav>\n            </Col>\n            <Col sm={10}>\n              <Tab.Content>\n                <Tab.Pane eventKey=\"Detail\">\n                  {this.state.user !== null && (\n                      <ThisUserProfile\n                        user={this.state.user}\n                        authUserId={this.context.userId}\n                        canDelete={this.state.canDelete}\n                        attendanceDelete={this.deleteUserAttendanceItem}\n                        leaveDelete={this.deleteUserLeaveItem}\n                        attachmentDelete={this.deleteUserAttachmentItem}\n                        onViewAttachment={this.onViewAttachment}\n                        onCreatePdf={this.createPdf}\n                      />\n                    )}\n                </Tab.Pane>\n\n                <Tab.Pane eventKey=\"Demographics\">\n                  <Button variant=\"outline-primary\" size=\"lg\" className=\"confirmEditButton\" onClick={this.startUpdateUserHandler}>Edit Demographics</Button>\n                  {this.state.updating === true && (\n                    <UpdateUserForm\n                    canCancelProfile\n                      canConfirm\n                      onCancel={this.modalCancelHandler}\n                      onConfirm={this.modalConfirmUpdateHandler}\n                      confirmText=\"Confirm\"\n                      user={this.state.user}\n                      authUserId={this.context.userId}\n                    />\n                  )}\n                </Tab.Pane>\n\n                <Tab.Pane eventKey=\"userEditField\">\n                  {this.state.selectedUser === null && (\n                    <Button variant=\"outline-warning\" size=\"lg\" className=\"confirmEditButton\">\n                      Select a Staff member from the Master List\n                    </Button>\n                  )}\n                  {this.state.selectedUser !== null && (\n                    <Button variant=\"outline-primary\" size=\"lg\" className=\"confirmEditButton\" onClick={this.startUpdateUserHandler}>Edit a Single Field</Button>\n                  )}\n                  {this.state.updating &&\n                    this.state.selectedUser !== null\n                    && (\n                      <UpdateUserFieldForm\n                        authUserId={this.context.userId}\n                        canCancel\n                        canConfirm\n                        onCancel={this.modalCancelHandler}\n                        onConfirm={this.modalConfirmUpdateFieldHandler}\n                        confirmText=\"Confirm\"\n                        user={this.state.selectedUser}\n                      />\n                  )}\n                </Tab.Pane>\n\n                <Tab.Pane eventKey=\"Attandance\">\n                  <Button variant=\"outline-primary\" size=\"lg\" className=\"confirmEditButton\" value='attendance' onClick={this.updateUserSpecialProfile.bind(this)}>Add Attendance</Button>\n                  {this.state.userUpdateField === 'attendance' && (\n                    <UpdateUserAttendanceForm\n                    authUserId={this.context.userId}\n                    canCancelProfile\n                      canConfirm\n                      onCancel={this.modalCancelHandler}\n                      onConfirm={this.updateUserAttendanceHandler}\n                      confirmText=\"Confirm\"\n                      user={this.state.selectedUser}\n                    />\n                  )}\n                </Tab.Pane>\n\n                <Tab.Pane eventKey=\"Attachment\">\n                  <Button variant=\"outline-primary\" size=\"lg\" className=\"confirmEditButton\" value='attachments' onClick={this.updateUserSpecialProfile.bind(this)}>Add Attachment</Button>\n                  {this.state.userUpdateField === 'attachments' && (\n                    <UpdateUserAttachmentForm\n                    authUserId={this.context.userId}\n                    canCancelProfile\n                      canConfirm\n                      onCancel={this.modalCancelHandler}\n                      onConfirm={this.updateUserAttachmentHandler}\n                      confirmText=\"Confirm\"\n                      user={this.state.selectedUser}\n                    />\n                  )}\n                </Tab.Pane>\n\n                <Tab.Pane eventKey=\"Leave\">\n                  <Button variant=\"outline-primary\" size=\"lg\" className=\"confirmEditButton\" value='leave' onClick={this.updateUserSpecialProfile.bind(this)}>Add Leave</Button>\n                  {this.state.userUpdateField === 'leave' && (\n                    <UpdateUserLeaveForm\n                    authUserId={this.context.userId}\n                    canCancelProfile\n                      canConfirm\n                      onCancel={this.modalCancelHandler}\n                      onConfirm={this.updateUserLeaveHandler}\n                      confirmText=\"Confirm\"\n                      user={this.state.selectedUser}\n                    />\n                  )}\n                </Tab.Pane>\n              </Tab.Content>\n            </Col>\n          </Row>\n        </Tab.Container>\n\n\n\n        </Container>\n      </Col>\n      </Row>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default ThisUserPage;\n"]},"metadata":{},"sourceType":"module"}