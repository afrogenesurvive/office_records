{"ast":null,"code":"import _classCallCheck from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import UpdateUserForm from'../components/Forms/UpdateUserForm';import Container from'react-bootstrap/Container';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import Accordion from'react-bootstrap/Accordion';import Button from'react-bootstrap/Button';import SidebarPage from'./Sidebar';import Tabs from'react-bootstrap/Tabs';import Tab from'react-bootstrap/Tab';import AlertBox from'../components/AlertBox';import UpdateUserFieldForm from'../components/Forms/UpdateUserFieldForm';import UpdateUserAttendanceForm from'../components/Forms/UpdateUserAttendanceForm';import UpdateUserAttachmentForm from'../components/Forms/UpdateUserAttachmentForm';import UpdateUserLeaveForm from'../components/Forms/UpdateUserLeaveForm';import ThisUserProfile from'../components/Users/thisUserProfile';import Spinner from'../components/Spinner/Spinner';import AuthContext from'../context/auth-context';import'./Users.css';var ThisUserPage=/*#__PURE__*/function(_Component){_inherits(ThisUserPage,_Component);function ThisUserPage(){var _getPrototypeOf2;var _this;_classCallCheck(this,ThisUserPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(ThisUserPage)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={user:null,users:[],updating:false,isLoading:false,userUpdateField:null,userAlert:null};_this.isActive=true;_this.startUpdateUserHandler=function(){_this.setState({updating:true});console.log(\"UpdateUserForm...\");};_this.modalConfirmUpdateHandler=function(event){var token=_this.context.token;var userId=_this.context.userId;var selectedUserId=_this.context.selectedUser._id;if(userId!==selectedUserId&&_this.context.user.role!=='admin'){console.log(\"Not the creator or Admin! No edit permission!!\");_this.setState({userAlert:\"Not the creator or Admin! No edit permission!!\"});selectedUserId=null;}console.log(\"UpdateUserFormData:  \",event.target.formGridEmail.value);_this.setState({updating:false});var email=event.target.formGridEmail.value;var password=event.target.formGridPassword.value;var name=event.target.formGridName.value;var role=_this.context.user.role;var dob=event.target.formGridDob.value;var phone=event.target.formGridPhone.value;var addressNumber=event.target.formGridAddressNumber.value;var addressStreet=event.target.formGridAddressStreet.value;var addressTown=event.target.formGridAddressTown.value;var addressParish=event.target.formGridAddressParish.value;var addressPostOffice=event.target.formGridAddressPostOffice.value;var employmentDate=event.target.formGridEmploymentDate.value;var terminationDate=event.target.formGridTerminationDate.value;if(email.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");email=_this.context.user.email;}if(password.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");password=_this.context.user.password;}if(name.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");name=_this.context.user.name;}// if (role.trim().length === 0) {\n//   console.log(\"blank fields detected!!!...filling w/ previous data...\");\n//   role = this.state.user.role;\n// }\nif(dob.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");dob=_this.context.user.dob;}if(phone.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");phone=_this.context.user.phone;}if(addressNumber.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressNumber=_this.context.user.address.number;}if(addressStreet.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressStreet=_this.context.user.address.street;}if(addressTown.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressTown=_this.context.user.address.town;}if(addressParish.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressParish=_this.context.user.address.parish;}if(addressPostOffice.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");addressPostOffice=_this.context.user.address.postOffice;}if(employmentDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");employmentDate=_this.context.user.employmentDate;}if(terminationDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");terminationDate=_this.context.user.terminationDate;}var user={email:email,password:password,name:name,role:role,dob:dob,phone:phone,addressNumber:addressNumber,addressStreet:addressStreet,addressTown:addressTown,addressParish:addressParish,addressPostOffice:addressPostOffice,employmentDate:employmentDate,terminationDate:terminationDate};console.log(\"\\n      updating user profile...\\n      userId: \".concat(userId,\"\\n      email: \").concat(email,\",\\n      password: \").concat(password,\",\\n      name: \").concat(name,\",\\n      role: \").concat(role,\",\\n      dob: \").concat(dob,\",\\n      phone: \").concat(phone,\",\\n      addressNumber: \").concat(addressNumber,\",\\n      addressStreet: \").concat(addressStreet,\",\\n      addressTown: \").concat(addressTown,\",\\n      addressParish: \").concat(addressParish,\",\\n      addressPostOffice: \").concat(addressPostOffice,\",\\n      employmentDate: \").concat(employmentDate,\",\\n      terminationDate: \").concat(terminationDate,\",\\n      \"));var requestBody={query:\"\\n        mutation {updateUser(userId:\\\"\".concat(userId,\"\\\",selectedUserId:\\\"\").concat(userId,\"\\\",userInput: {email:\\\"\").concat(email,\"\\\",password:\\\"\").concat(password,\"\\\",name:\\\"\").concat(name,\"\\\",dob:\\\"\").concat(dob,\"\\\",addressNumber:\").concat(addressNumber,\",addressStreet:\\\"\").concat(addressStreet,\"\\\",addressTown:\\\"\").concat(addressTown,\"\\\",addressParish:\\\"\").concat(addressParish,\"\\\", addressPostOffice:\\\"\").concat(addressPostOffice,\"\\\",phone:\\\"\").concat(phone,\"\\\",role:\\\"\").concat(role,\"\\\",employmentDate:\\\"\").concat(employmentDate,\"\\\",terminationDate:\\\"\").concat(terminationDate,\"\\\"})\\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n        \")};fetch('http://localhost:10000/graphql',{method:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData));var updatedUser=resData.data.updateUser;console.log(\"updatedUser:  \",JSON.stringify(updatedUser));_this.state.users.push(updatedUser);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert,user:updatedUser});_this.fetchUsers();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.modalConfirmUpdateFieldHandler=function(event){var token=_this.context.token;var userId=_this.context.userId;var selectedUserId=_this.context.selectedUser._id;if(userId!==selectedUserId&&_this.context.user.role!=='admin'){console.log(\"Not the creator or Admin! No edit permission!!\");_this.setState({userAlert:\"Not the creator or Admin! No edit permission!!\"});selectedUserId=null;}console.log(\"UpdateUserFieldFormData:  \",event.target.formGridField.value);_this.setState({updating:false});var field=event.target.formGridField.value;var query=event.target.formGridQuery.value;var requestBody={query:\"\\n            mutation{updateUserField(userId:\\\"\".concat(userId,\"\\\",selectedUserId:\\\"\").concat(userId,\"\\\",field:\\\"\").concat(field,\"\\\",query:\\\"\").concat(query,\"\\\")\\n            {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n          \")};fetch('http://localhost:10000/graphql',{method:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData.data.updateUserField));var updatedUserId=resData.data.updateUserField._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.updateUserField);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});_this.fetchUsers();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.updateUserAttendanceHandler=function(event){var token=_this.context.token;var userId=_this.state.user._id;// let selectedUserId = this.context.selectedUser._id;\n// if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n//   console.log(\"Not the creator or Admin! No edit permission!!\");\n//   selectedUserId = null;\n// }\nconsole.log(\"UpdateUserAttendanceFormData:  \",event.target.formGridAttendanceDate.value);_this.setState({updating:false,userUpdateField:null});var attendanceDate=event.target.formGridAttendanceDate.value;var attendanceStatus=event.target.formGridAttendanceStatus.value;var attendanceDescription=event.target.formGridAttendanceDescription.value;if(attendanceDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");attendanceDate=_this.context.selectedUser.attendanceDate;}if(attendanceStatus.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");attendanceStatus=_this.context.selectedUser.attendanceStatus;}if(attendanceDescription.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");attendanceDescription=_this.context.selectedUser.attendanceDescription;}var userAttendance={attendanceDate:attendanceDate,attendanceStatus:attendanceStatus,attendanceDescription:attendanceDescription};console.log(\"\\n      adding user attendance item...\\n      userId: \".concat(userId,\",\\n      attendanceDate: \").concat(attendanceDate,\",\\n      attendanceStatus: \").concat(attendanceStatus,\",\\n      attendanceDescription: \").concat(attendanceDescription,\"\\n      \"));var requestBody={query:\"\\n          mutation {updateUserAttendance(userId:\\\"\".concat(userId,\"\\\", selectedUserId:\\\"\").concat(userId,\"\\\",userInput:{attendanceDate:\\\"\").concat(attendanceDate,\"\\\",attendanceStatus:\\\"\").concat(attendanceStatus,\"\\\",attendanceDescription:\\\"\").concat(attendanceDescription,\"\\\"})\\n          {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n        \")};fetch('http://localhost:10000/graphql',{method:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData.data.updateUserAttendance));var updatedUserId=resData.data.updateUserAttendance._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.updateUserAttendance);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});_this.fetchUsers();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.updateUserLeaveHandler=function(event){var token=_this.context.token;var userId=_this.context.userId;var selectedUserId=_this.context.selectedUser._id;if(userId!==selectedUserId&&_this.context.user.role!=='admin'){console.log(\"Not the creator or Admin! No edit permission!!\");_this.setState({userAlert:\"Not the creator or Admin! No edit permission!!\"});selectedUserId=null;}console.log(\"UpdateUserLeaveFormData:  \",event.target.formGridLeaveType.value);_this.setState({updating:false,userUpdateField:null});var leaveType=event.target.formGridLeaveType.value;var leaveTitle=event.target.formGridLeaveTitle.value;var leaveStartDate=event.target.formGridLeaveStartDate.value;var leaveEndDate=event.target.formGridLeaveEndDate.value;if(leaveType.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");leaveType=_this.context.selectedUser.leaveType;}if(leaveTitle.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");leaveTitle=_this.context.selectedUser.leaveTitle;}if(leaveStartDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");leaveStartDate=_this.context.selectedUser.leaveStartDate;}if(leaveEndDate.trim().length===0){console.log(\"blank fields detected!!!...filling w/ previous data...\");leaveEndDate=_this.context.selectedUser.leaveEndDate;}var userLeave={leaveType:leaveType,leaveTitle:leaveTitle,leaveStartDate:leaveStartDate,leaveEndDate:leaveEndDate};console.log(\"\\n      adding user attendance item...\\n      userId: \".concat(userId,\",\\n      selectedUserId: \").concat(selectedUserId,\"\\n      leave: {\\n        type: \").concat(leaveType,\",\\n        title: \").concat(leaveTitle,\",\\n        startDate: \").concat(leaveStartDate,\",\\n        endDate: \").concat(leaveEndDate,\"\\n      }\\n      \"));var requestBody={query:\"\\n          mutation {updateUserLeave(userId:\\\"\".concat(userId,\"\\\", selectedUserId:\\\"\").concat(userId,\"\\\",userInput:{leaveType:\\\"\").concat(leaveType,\"\\\",leaveTitle:\\\"\").concat(leaveTitle,\"\\\",leaveStartDate:\\\"\").concat(leaveStartDate,\"\\\",leaveEndDate:\\\"\").concat(leaveEndDate,\"\\\"})\\n          {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n        \")};fetch('http://localhost:10000/graphql',{method:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData.data));var updatedUserId=resData.data.updateUserLeave._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.updateUserLeave);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});_this.fetchUsers();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.updateUserAttachmentHandler=function(event){var token=_this.context.token;var userId=_this.context.userId;var selectedUserId=_this.context.selectedUser._id;// if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n//   console.log(\"Not the creator or Admin! No edit permission!!\");\n//   selectedUserId = null;\n// }\nif(userId!==selectedUserId&&_this.context.user.role!==\"admin\"){console.log(\"Not the creator or Admin! No edit permission!!\");_this.setState({userAlert:\"Not the creator or Admin! No edit permission!!\"});selectedUserId=null;}console.log(\"UpdateUserAttachmentFormData:  \",event.target.formGridAttachmentName.value);_this.setState({updating:false,userUpdateField:null});var attachmentName=event.target.formGridAttachmentName.value;var attachmentFormat=event.target.formGridAttachmentFormat.value;var attachmentPath=event.target.formGridAttachmentPath.value;if(attachmentName.trim().length===0||attachmentFormat.trim().length===0||attachmentPath.trim().length===0){console.log(\"blank fields detected!!! try again\");return;}var userAttachment={attachmentName:attachmentName,attachmentFormat:attachmentFormat,attachmentPath:attachmentPath};console.log(\"\\n    adding user attendance item...\\n    userId: \".concat(userId,\",\\n    selectedUserId: \").concat(selectedUserId,\"\\n    attachmentName: \").concat(attachmentName,\",\\n    attachmentFormat: \").concat(attachmentFormat,\",\\n    attachmentPath: \").concat(attachmentPath,\"\\n    \"));_this.setState({userAlert:\"adding user attendance item...\"});var requestBody={query:\"\\n        mutation{updateUserAttachment(userId:\\\"\".concat(userId,\"\\\",selectedUserId:\\\"\").concat(userId,\"\\\",userInput:{attachmentName:\\\"\").concat(attachmentName,\"\\\",attachmentFormat:\\\"\").concat(attachmentFormat,\"\\\",attachmentPath:\\\"\").concat(attachmentPath,\"\\\"})\\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n      \")};fetch('http://localhost:10000/graphql',{method:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"response data... \"+JSON.stringify(resData.data.updateUserAttachment));var updatedUserId=resData.data.updateUserAttachment._id;var updatedUser=_this.state.users.find(function(e){return e._id===updatedUserId;});var updatedUserPos=_this.state.users.indexOf(updatedUser);var slicedArray=_this.state.users.splice(updatedUserPos,1);console.log(\"updatedUser:  \",JSON.stringify(updatedUser),\"  updatedUserPos:  \",updatedUserPos,\"  slicedArray:  \",slicedArray);_this.state.users.push(resData.data.updateUserAttachment);_this.context.users=_this.state.users;var responseAlert=JSON.stringify(resData.data).slice(2,25);_this.setState({userAlert:responseAlert});_this.fetchUsers();}).catch(function(err){console.log(err);_this.setState({userAlert:err});});};_this.modalCancelHandler=function(){_this.setState({updating:false});};return _this;}_createClass(ThisUserPage,[{key:\"componentDidMount\",// constructor(props) {\n//   super(props);\n// }\nvalue:function componentDidMount(){this.getThisUser();}},{key:\"getThisUser\",value:function getThisUser(){var _this2=this;this.setState({isLoading:true});var requestBody={query:\"\\n      query {getThisUser\\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\\n        \"};fetch('http://localhost:10000/graphql',{method:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json',Authorization:'Bearer '+this.context.token}}).then(function(res){if(res.status!==200&&res.status!==201){throw new Error('Failed!');}return res.json();}).then(function(resData){console.log(\"resdata...\"+JSON.stringify(resData));var thisUser=resData.data.getThisUser;if(_this2.isActive){_this2.setState({user:thisUser,isLoading:false});_this2.context.user=thisUser;console.log(\"this.context.user:  \"+_this2.context.user.name);sessionStorage.setItem('thisUser',JSON.stringify(thisUser));}}).catch(function(err){console.log(err);_this2.setState({userAlert:err});if(_this2.isActive){_this2.setState({isLoading:false});}});}},{key:\"updateUserSpecialProfile\",value:function updateUserSpecialProfile(event){console.log(\"special field to update:  \",event.target.value);var field=event.target.value;this.setState({userUpdateField:field});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.isActive=false;}},{key:\"render\",value:function render(){return React.createElement(React.Fragment,null,React.createElement(Row,null,React.createElement(Col,{md:3,className:\"MasterCol1\"},React.createElement(AlertBox,{authUserId:this.context.userId,alert:this.state.userAlert}),React.createElement(SidebarPage,{you:this.state.user})),React.createElement(Col,{md:9,className:\"MasterCol2\"},React.createElement(Container,{className:\"containerProfile\"},React.createElement(Tabs,{defaultActiveKey:\"Detail\",id:\"uncontrolled-tab-example2\"},React.createElement(Tab,{eventKey:\"\",title:\"Edit:\",disabled:true}),React.createElement(Tab,{eventKey:\"Detail\",title:\"Detail\"},this.state.user!==null&&React.createElement(ThisUserProfile,{user:this.state.user,authUserId:this.context.userId})),React.createElement(Tab,{eventKey:\"Demographics\",title:\"Demographics\"},React.createElement(Button,{variant:\"outline-primary\",onClick:this.startUpdateUserHandler},\"Demographics\"),this.state.updating===true&&React.createElement(UpdateUserForm,{canCancelProfile:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.modalConfirmUpdateHandler,confirmText:\"Confirm\",user:this.state.user,authUserId:this.context.userId})),React.createElement(Tab,{eventKey:\"userEditField\",title:\"Single Field\"},this.state.selectedUser===null&&React.createElement(Button,{variant:\"outline-warning\",size:\"lg\"},\"Select a Staff member from the Master List below\"),this.state.selectedUser!==null&&React.createElement(Button,{variant:\"outline-primary\",onClick:this.startUpdateUserHandler},\"Edit Field\"),this.state.updating&&this.state.selectedUser!==null&&React.createElement(UpdateUserFieldForm,{authUserId:this.context.userId,canCancel:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.modalConfirmUpdateFieldHandler,confirmText:\"Confirm\",user:this.state.selectedUser})),React.createElement(Tab,{eventKey:\"Atttendance\",title:\"Atttendance\"},React.createElement(Button,{variant:\"outline-primary\",value:\"attendance\",onClick:this.updateUserSpecialProfile.bind(this)},\"Attendance\"),this.state.userUpdateField==='attendance'&&React.createElement(UpdateUserAttendanceForm,{authUserId:this.context.userId,canCancelProfile:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.updateUserAttendanceHandler,confirmText:\"Confirm\",user:this.state.selectedUser})),React.createElement(Tab,{eventKey:\"Leave\",title:\"Leave\"},React.createElement(Button,{variant:\"outline-primary\",value:\"leave\",onClick:this.updateUserSpecialProfile.bind(this)},\"Leave\"),this.state.userUpdateField==='leave'&&React.createElement(UpdateUserLeaveForm,{authUserId:this.context.userId,canCancelProfile:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.updateUserLeaveHandler,confirmText:\"Confirm\",user:this.state.selectedUser})),React.createElement(Tab,{eventKey:\"Attachment\",title:\"Attachment\"},React.createElement(Button,{variant:\"outline-primary\",value:\"attachments\",onClick:this.updateUserSpecialProfile.bind(this)},\"Attachment\"),this.state.userUpdateField==='attachments'&&React.createElement(UpdateUserAttachmentForm,{authUserId:this.context.userId,canCancelProfile:true,canConfirm:true,onCancel:this.modalCancelHandler,onConfirm:this.updateUserAttachmentHandler,confirmText:\"Confirm\",user:this.state.selectedUser})))))));}}]);return ThisUserPage;}(Component);ThisUserPage.contextType=AuthContext;export default ThisUserPage;","map":{"version":3,"sources":["/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/src/pages/thisUser.js"],"names":["React","Component","UpdateUserForm","Container","Row","Col","Accordion","Button","SidebarPage","Tabs","Tab","AlertBox","UpdateUserFieldForm","UpdateUserAttendanceForm","UpdateUserAttachmentForm","UpdateUserLeaveForm","ThisUserProfile","Spinner","AuthContext","ThisUserPage","state","user","users","updating","isLoading","userUpdateField","userAlert","isActive","startUpdateUserHandler","setState","console","log","modalConfirmUpdateHandler","event","token","context","userId","selectedUserId","selectedUser","_id","role","target","formGridEmail","value","email","password","formGridPassword","name","formGridName","dob","formGridDob","phone","formGridPhone","addressNumber","formGridAddressNumber","addressStreet","formGridAddressStreet","addressTown","formGridAddressTown","addressParish","formGridAddressParish","addressPostOffice","formGridAddressPostOffice","employmentDate","formGridEmploymentDate","terminationDate","formGridTerminationDate","trim","length","address","number","street","town","parish","postOffice","requestBody","query","fetch","method","body","JSON","stringify","headers","Authorization","then","res","status","Error","json","resData","updatedUser","data","updateUser","push","responseAlert","slice","fetchUsers","catch","err","modalConfirmUpdateFieldHandler","formGridField","field","formGridQuery","updateUserField","updatedUserId","find","e","updatedUserPos","indexOf","slicedArray","splice","updateUserAttendanceHandler","formGridAttendanceDate","attendanceDate","attendanceStatus","formGridAttendanceStatus","attendanceDescription","formGridAttendanceDescription","userAttendance","updateUserAttendance","updateUserLeaveHandler","formGridLeaveType","leaveType","leaveTitle","formGridLeaveTitle","leaveStartDate","formGridLeaveStartDate","leaveEndDate","formGridLeaveEndDate","userLeave","updateUserLeave","updateUserAttachmentHandler","formGridAttachmentName","attachmentName","attachmentFormat","formGridAttachmentFormat","attachmentPath","formGridAttachmentPath","userAttachment","updateUserAttachment","modalCancelHandler","getThisUser","thisUser","sessionStorage","setItem","updateUserSpecialProfile","bind","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport UpdateUserForm from '../components/Forms/UpdateUserForm';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Accordion from 'react-bootstrap/Accordion';\nimport Button from 'react-bootstrap/Button';\nimport SidebarPage from './Sidebar';\nimport Tabs from 'react-bootstrap/Tabs';\nimport Tab from 'react-bootstrap/Tab';\n\nimport AlertBox from '../components/AlertBox';\nimport UpdateUserFieldForm from '../components/Forms/UpdateUserFieldForm';\nimport UpdateUserAttendanceForm from '../components/Forms/UpdateUserAttendanceForm';\nimport UpdateUserAttachmentForm from '../components/Forms/UpdateUserAttachmentForm';\nimport UpdateUserLeaveForm from '../components/Forms/UpdateUserLeaveForm';\n\nimport ThisUserProfile from '../components/Users/thisUserProfile';\nimport Spinner from '../components/Spinner/Spinner';\nimport AuthContext from '../context/auth-context';\nimport './Users.css';\n\nclass ThisUserPage extends Component {\n  state = {\n    user: null,\n    users: [],\n    updating: false,\n    isLoading: false,\n    userUpdateField: null,\n    userAlert: null,\n  };\n  isActive = true;\n\n  static contextType = AuthContext;\n\n  // constructor(props) {\n  //   super(props);\n  // }\n\n  componentDidMount() {\n    this.getThisUser();\n  }\n\n  startUpdateUserHandler = () => {\n    this.setState({ updating: true });\n    console.log(\"UpdateUserForm...\");\n  };\n\n\n  modalConfirmUpdateHandler = (event) => {\n    const token = this.context.token;\n    let userId = this.context.userId;\n    let selectedUserId = this.context.selectedUser._id;\n    if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n      console.log(\"Not the creator or Admin! No edit permission!!\");\n      this.setState({userAlert: \"Not the creator or Admin! No edit permission!!\"});\n      selectedUserId = null;\n    }\n    console.log(\"UpdateUserFormData:  \", event.target.formGridEmail.value);\n    this.setState({ updating: false });\n    let email = event.target.formGridEmail.value;\n    let password = event.target.formGridPassword.value;\n    let name = event.target.formGridName.value;\n    let role = this.context.user.role;\n    let dob = event.target.formGridDob.value;\n    let phone = event.target.formGridPhone.value;\n    let addressNumber = event.target.formGridAddressNumber.value;\n    let addressStreet = event.target.formGridAddressStreet.value;\n    let addressTown = event.target.formGridAddressTown.value;\n    let addressParish = event.target.formGridAddressParish.value;\n    let addressPostOffice = event.target.formGridAddressPostOffice.value;\n    let employmentDate = event.target.formGridEmploymentDate.value;\n    let terminationDate = event.target.formGridTerminationDate.value;\n\n    if (email.trim().length === 0 ) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      email = this.context.user.email;\n    }\n    if (password.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      password = this.context.user.password;\n    }\n    if (name.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      name = this.context.user.name;\n    }\n    // if (role.trim().length === 0) {\n    //   console.log(\"blank fields detected!!!...filling w/ previous data...\");\n    //   role = this.state.user.role;\n    // }\n    if (dob.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      dob = this.context.user.dob;\n    }\n    if (phone.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      phone = this.context.user.phone;\n    }\n    if (addressNumber.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressNumber = this.context.user.address.number;\n    }\n    if (addressStreet.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressStreet = this.context.user.address.street;\n    }\n    if (addressTown.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressTown = this.context.user.address.town;\n    }\n    if (addressParish.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressParish = this.context.user.address.parish;\n    }\n    if (addressPostOffice.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      addressPostOffice = this.context.user.address.postOffice;\n    }\n    if (employmentDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      employmentDate = this.context.user.employmentDate;\n    }\n    if (terminationDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      terminationDate = this.context.user.terminationDate;\n    }\n\n\n    const user = { email, password, name, role, dob, phone, addressNumber, addressStreet, addressTown, addressParish, addressPostOffice, employmentDate, terminationDate };\n    console.log(`\n      updating user profile...\n      userId: ${userId}\n      email: ${email},\n      password: ${password},\n      name: ${name},\n      role: ${role},\n      dob: ${dob},\n      phone: ${phone},\n      addressNumber: ${addressNumber},\n      addressStreet: ${addressStreet},\n      addressTown: ${addressTown},\n      addressParish: ${addressParish},\n      addressPostOffice: ${addressPostOffice},\n      employmentDate: ${employmentDate},\n      terminationDate: ${terminationDate},\n      `);\n\n    const requestBody = {\n      query: `\n        mutation {updateUser(userId:\\\"${userId}\\\",selectedUserId:\\\"${userId}\\\",userInput: {email:\\\"${email}\\\",password:\\\"${password}\\\",name:\\\"${name}\\\",dob:\\\"${dob}\\\",addressNumber:${addressNumber},addressStreet:\\\"${addressStreet}\\\",addressTown:\\\"${addressTown}\\\",addressParish:\\\"${addressParish}\\\", addressPostOffice:\\\"${addressPostOffice}\\\",phone:\\\"${phone}\\\",role:\\\"${role}\\\",employmentDate:\\\"${employmentDate}\\\",terminationDate:\\\"${terminationDate}\\\"})\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n        `};\n\n    fetch('http://localhost:10000/graphql', {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + token\n      }})\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error('Failed!');\n        }\n        return res.json();\n      })\n      .then(resData => {\n        console.log(\"response data... \" + JSON.stringify(resData));\n\n        const updatedUser = resData.data.updateUser;\n        console.log(\"updatedUser:  \", JSON.stringify(updatedUser));\n        this.state.users.push(updatedUser);\n        this.context.users = this.state.users;\n\n        const responseAlert = JSON.stringify(resData.data).slice(2,25);\n        this.setState({ userAlert: responseAlert, user: updatedUser})\n        this.fetchUsers();\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({userAlert: err});\n      });\n    };\n\n    modalConfirmUpdateFieldHandler = (event) => {\n\n      const token = this.context.token;\n      const userId = this.context.userId;\n      let selectedUserId = this.context.selectedUser._id;\n      if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n        console.log(\"Not the creator or Admin! No edit permission!!\");\n        this.setState({userAlert: \"Not the creator or Admin! No edit permission!!\"});\n        selectedUserId = null;\n      }\n\n        console.log(\"UpdateUserFieldFormData:  \", event.target.formGridField.value);\n        this.setState({ updating: false });\n\n        let field = event.target.formGridField.value;\n        let query = event.target.formGridQuery.value;\n\n        const requestBody = {\n          query:`\n            mutation{updateUserField(userId:\\\"${userId}\\\",selectedUserId:\\\"${userId}\\\",field:\\\"${field}\\\",query:\\\"${query}\\\")\n            {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n          `};\n\n        fetch('http://localhost:10000/graphql', {\n          method: 'POST',\n          body: JSON.stringify(requestBody),\n          headers: {\n            'Content-Type': 'application/json',\n            Authorization: 'Bearer ' + token\n          }\n        })\n          .then(res => {\n            if (res.status !== 200 && res.status !== 201) {\n              throw new Error('Failed!');\n            }\n            return res.json();\n          })\n          .then(resData => {\n            console.log(\"response data... \" + JSON.stringify(resData.data.updateUserField));\n\n            const updatedUserId = resData.data.updateUserField._id;\n            const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n            const updatedUserPos = this.state.users.indexOf(updatedUser);\n            const slicedArray = this.state.users.splice(updatedUserPos, 1);\n            console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n\n            this.state.users.push(resData.data.updateUserField);\n            this.context.users = this.state.users;\n            const responseAlert = JSON.stringify(resData.data).slice(2,25);\n            this.setState({ userAlert: responseAlert})\n            this.fetchUsers();\n          })\n          .catch(err => {\n            console.log(err);\n            this.setState({userAlert: err});\n          });\n\n    }\n\n  updateUserAttendanceHandler = (event) => {\n    const token = this.context.token;\n    const userId = this.state.user._id;\n    // let selectedUserId = this.context.selectedUser._id;\n    // if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n    //   console.log(\"Not the creator or Admin! No edit permission!!\");\n    //   selectedUserId = null;\n    // }\n    console.log(\"UpdateUserAttendanceFormData:  \", event.target.formGridAttendanceDate.value);\n\n    this.setState({ updating: false , userUpdateField: null });\n\n    let attendanceDate = event.target.formGridAttendanceDate.value;\n    let attendanceStatus = event.target.formGridAttendanceStatus.value;\n    let attendanceDescription = event.target.formGridAttendanceDescription.value;\n\n    if (attendanceDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      attendanceDate = this.context.selectedUser.attendanceDate;\n    }\n    if (attendanceStatus.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      attendanceStatus = this.context.selectedUser.attendanceStatus;\n    }\n    if (attendanceDescription.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      attendanceDescription = this.context.selectedUser.attendanceDescription;\n    }\n\n    const userAttendance = { attendanceDate, attendanceStatus, attendanceDescription }\n    console.log(`\n      adding user attendance item...\n      userId: ${userId},\n      attendanceDate: ${attendanceDate},\n      attendanceStatus: ${attendanceStatus},\n      attendanceDescription: ${attendanceDescription}\n      `);\n\n      const requestBody = {\n        query:`\n          mutation {updateUserAttendance(userId:\"${userId}\", selectedUserId:\"${userId}\",userInput:{attendanceDate:\"${attendanceDate}\",attendanceStatus:\"${attendanceStatus}\",attendanceDescription:\"${attendanceDescription}\"})\n          {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n        `};\n\n      fetch('http://localhost:10000/graphql', {\n        method: 'POST',\n        body: JSON.stringify(requestBody),\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer ' + token\n        }})\n        .then(res => {\n          if (res.status !== 200 && res.status !== 201) {\n            throw new Error('Failed!');\n          }\n          return res.json();\n        })\n        .then(resData => {\n          console.log(\"response data... \" + JSON.stringify(resData.data.updateUserAttendance));\n\n          const updatedUserId = resData.data.updateUserAttendance._id;\n          const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n          const updatedUserPos = this.state.users.indexOf(updatedUser);\n          const slicedArray = this.state.users.splice(updatedUserPos, 1);\n          console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n          this.state.users.push(resData.data.updateUserAttendance);\n          this.context.users = this.state.users;\n          const responseAlert = JSON.stringify(resData.data).slice(2,25);\n          this.setState({ userAlert: responseAlert})\n          this.fetchUsers();\n        })\n        .catch(err => {\n          console.log(err);\n          this.setState({userAlert: err});\n        });\n  };\n\n\n  updateUserLeaveHandler = (event) => {\n    const token = this.context.token;\n    const userId = this.context.userId;\n    let selectedUserId = this.context.selectedUser._id;\n    if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n      console.log(\"Not the creator or Admin! No edit permission!!\");\n      this.setState({userAlert: \"Not the creator or Admin! No edit permission!!\"});\n      selectedUserId = null;\n    }\n\n    console.log(\"UpdateUserLeaveFormData:  \", event.target.formGridLeaveType.value);\n\n    this.setState({ updating: false , userUpdateField: null });\n\n    let leaveType = event.target.formGridLeaveType.value;\n    let leaveTitle = event.target.formGridLeaveTitle.value;\n    let leaveStartDate = event.target.formGridLeaveStartDate.value;\n    let leaveEndDate = event.target.formGridLeaveEndDate.value;\n\n    if (leaveType.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      leaveType = this.context.selectedUser.leaveType;\n    }\n    if (leaveTitle.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      leaveTitle = this.context.selectedUser.leaveTitle;\n    }\n    if (leaveStartDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      leaveStartDate = this.context.selectedUser.leaveStartDate;\n    }\n    if (leaveEndDate.trim().length === 0) {\n      console.log(\"blank fields detected!!!...filling w/ previous data...\");\n      leaveEndDate = this.context.selectedUser.leaveEndDate;\n    }\n\n    const userLeave = { leaveType, leaveTitle, leaveStartDate, leaveEndDate }\n    console.log(`\n      adding user attendance item...\n      userId: ${userId},\n      selectedUserId: ${selectedUserId}\n      leave: {\n        type: ${leaveType},\n        title: ${leaveTitle},\n        startDate: ${leaveStartDate},\n        endDate: ${leaveEndDate}\n      }\n      `);\n\n      const requestBody = {\n        query:`\n          mutation {updateUserLeave(userId:\"${userId}\", selectedUserId:\"${userId}\",userInput:{leaveType:\"${leaveType}\",leaveTitle:\"${leaveTitle}\",leaveStartDate:\"${leaveStartDate}\",leaveEndDate:\"${leaveEndDate}\"})\n          {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n        `};\n\n      fetch('http://localhost:10000/graphql', {\n        method: 'POST',\n        body: JSON.stringify(requestBody),\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer ' + token\n        }})\n        .then(res => {\n          if (res.status !== 200 && res.status !== 201) {\n            throw new Error('Failed!');\n          }\n          return res.json();\n        })\n        .then(resData => {\n          console.log(\"response data... \" + JSON.stringify(resData.data));\n\n          const updatedUserId = resData.data.updateUserLeave._id;\n          const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n          const updatedUserPos = this.state.users.indexOf(updatedUser);\n          const slicedArray = this.state.users.splice(updatedUserPos, 1);\n          console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n\n          this.state.users.push(resData.data.updateUserLeave);\n          this.context.users = this.state.users;\n          const responseAlert = JSON.stringify(resData.data).slice(2,25);\n          this.setState({ userAlert: responseAlert})\n          this.fetchUsers();\n        })\n        .catch(err => {\n          console.log(err);\n          this.setState({userAlert: err});\n        });\n  };\n\n\n  updateUserAttachmentHandler = (event) => {\n\n  const token = this.context.token;\n  const userId = this.context.userId;\n  let selectedUserId = this.context.selectedUser._id;\n  // if(userId !== selectedUserId && this.context.user.role !== 'admin') {\n  //   console.log(\"Not the creator or Admin! No edit permission!!\");\n  //   selectedUserId = null;\n  // }\n  if (userId !== selectedUserId && this.context.user.role !== \"admin\" ) {\n    console.log(\"Not the creator or Admin! No edit permission!!\");\n    this.setState({userAlert: \"Not the creator or Admin! No edit permission!!\"})\n      selectedUserId = null;\n  }\n\n  console.log(\"UpdateUserAttachmentFormData:  \", event.target.formGridAttachmentName.value);\n\n  this.setState({ updating: false , userUpdateField: null });\n\n  let attachmentName = event.target.formGridAttachmentName.value;\n  let attachmentFormat = event.target.formGridAttachmentFormat.value;\n  let attachmentPath = event.target.formGridAttachmentPath.value;\n\n\n  if (\n    attachmentName.trim().length === 0 ||\n    attachmentFormat.trim().length === 0 ||\n    attachmentPath.trim().length === 0\n) {\n    console.log(\"blank fields detected!!! try again\");\n    return\n  }\n\n  const userAttachment = { attachmentName, attachmentFormat, attachmentPath }\n  console.log(`\n    adding user attendance item...\n    userId: ${userId},\n    selectedUserId: ${selectedUserId}\n    attachmentName: ${attachmentName},\n    attachmentFormat: ${attachmentFormat},\n    attachmentPath: ${attachmentPath}\n    `);\n    this.setState({userAlert: \"adding user attendance item...\"})\n\n    const requestBody = {\n      query:`\n        mutation{updateUserAttachment(userId:\\\"${userId}\\\",selectedUserId:\\\"${userId}\\\",userInput:{attachmentName:\\\"${attachmentName}\\\",attachmentFormat:\\\"${attachmentFormat}\\\",attachmentPath:\\\"${attachmentPath}\\\"})\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n      `};\n\n    fetch('http://localhost:10000/graphql', {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + token\n      }\n    })\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error('Failed!');\n        }\n        return res.json();\n      })\n      .then(resData => {\n        console.log(\"response data... \" + JSON.stringify(resData.data.updateUserAttachment));\n\n        const updatedUserId = resData.data.updateUserAttachment._id;\n        const updatedUser = this.state.users.find(e => e._id === updatedUserId);\n        const updatedUserPos = this.state.users.indexOf(updatedUser);\n        const slicedArray = this.state.users.splice(updatedUserPos, 1);\n        console.log(\"updatedUser:  \", JSON.stringify(updatedUser),\"  updatedUserPos:  \", updatedUserPos, \"  slicedArray:  \", slicedArray);\n\n        this.state.users.push(resData.data.updateUserAttachment);\n        this.context.users = this.state.users;\n        const responseAlert = JSON.stringify(resData.data).slice(2,25);\n        this.setState({ userAlert: responseAlert})\n        this.fetchUsers();\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({userAlert: err});\n      });\n\n\n}\n\n\n  getThisUser() {\n    this.setState({ isLoading: true });\n    const requestBody = {\n      query: `\n      query {getThisUser\n        {_id,email,password,name,dob,address{number,street,town,parish,postOffice},phone,role,employmentDate,terminationDate,attachments{name,format,path},attendance{date,status,description},leave{type,title,startDate,endDate}}}\n        `};\n\n    fetch('http://localhost:10000/graphql', {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + this.context.token\n      }})\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error('Failed!');\n        }\n        return res.json();\n      })\n      .then(resData => {\n        console.log(\"resdata...\" + JSON.stringify(resData));\n        const thisUser = resData.data.getThisUser;\n        if (this.isActive) {\n\n          this.setState({ user: thisUser, isLoading: false });\n\n          this.context.user = thisUser;\n          console.log(\"this.context.user:  \" + this.context.user.name);\n\n          sessionStorage.setItem('thisUser', JSON.stringify(thisUser));\n        }\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({userAlert: err});\n        if (this.isActive) {\n          this.setState({ isLoading: false });\n        }\n      });\n  }\n\n\n  modalCancelHandler = () => {\n    this.setState({ updating: false  });\n  };\n\n  updateUserSpecialProfile (event) {\n    console.log(\"special field to update:  \", event.target.value);\n    const field = event.target.value;\n    this.setState({ userUpdateField: field});\n  }\n\n\n  componentWillUnmount() {\n    this.isActive = false;\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n      <Row>\n      <Col md={3} className=\"MasterCol1\">\n      <AlertBox\n        authUserId={this.context.userId}\n        alert={this.state.userAlert}\n      />\n      <SidebarPage\n        you={this.state.user}\n      />\n      </Col>\n\n      <Col md={9} className=\"MasterCol2\">\n        <Container className=\"containerProfile\">\n        <Tabs defaultActiveKey=\"Detail\" id=\"uncontrolled-tab-example2\">\n          <Tab eventKey=\"\" title=\"Edit:\" disabled>\n          </Tab>\n          <Tab eventKey=\"Detail\" title=\"Detail\">\n          {this.state.user !== null && (\n              <ThisUserProfile\n                user={this.state.user}\n                authUserId={this.context.userId}\n              />\n            )}\n          </Tab>\n\n          <Tab eventKey=\"Demographics\" title=\"Demographics\">\n          <Button variant=\"outline-primary\" onClick={this.startUpdateUserHandler}>Demographics</Button>\n          {this.state.updating === true && (\n            <UpdateUserForm\n            canCancelProfile\n              canConfirm\n              onCancel={this.modalCancelHandler}\n              onConfirm={this.modalConfirmUpdateHandler}\n              confirmText=\"Confirm\"\n              user={this.state.user}\n              authUserId={this.context.userId}\n            />\n          )}\n          </Tab>\n\n          <Tab eventKey=\"userEditField\" title=\"Single Field\">\n          {this.state.selectedUser === null && (\n            <Button variant=\"outline-warning\" size=\"lg\">\n              Select a Staff member from the Master List below\n            </Button>\n          )}\n          {this.state.selectedUser !== null && (\n            <Button variant=\"outline-primary\" onClick={this.startUpdateUserHandler}>Edit Field</Button>\n          )}\n          {this.state.updating &&\n            this.state.selectedUser !== null\n            && (\n              <UpdateUserFieldForm\n                authUserId={this.context.userId}\n                canCancel\n                canConfirm\n                onCancel={this.modalCancelHandler}\n                onConfirm={this.modalConfirmUpdateFieldHandler}\n                confirmText=\"Confirm\"\n                user={this.state.selectedUser}\n              />\n          )}\n          </Tab>\n\n          <Tab eventKey=\"Atttendance\" title=\"Atttendance\">\n            <Button variant=\"outline-primary\" value='attendance' onClick={this.updateUserSpecialProfile.bind(this)}>Attendance</Button>\n            {this.state.userUpdateField === 'attendance' && (\n              <UpdateUserAttendanceForm\n              authUserId={this.context.userId}\n              canCancelProfile\n                canConfirm\n                onCancel={this.modalCancelHandler}\n                onConfirm={this.updateUserAttendanceHandler}\n                confirmText=\"Confirm\"\n                user={this.state.selectedUser}\n              />\n            )}\n          </Tab>\n\n          <Tab eventKey=\"Leave\" title=\"Leave\">\n            <Button variant=\"outline-primary\" value='leave' onClick={this.updateUserSpecialProfile.bind(this)}>Leave</Button>\n            {this.state.userUpdateField === 'leave' && (\n              <UpdateUserLeaveForm\n              authUserId={this.context.userId}\n              canCancelProfile\n                canConfirm\n                onCancel={this.modalCancelHandler}\n                onConfirm={this.updateUserLeaveHandler}\n                confirmText=\"Confirm\"\n                user={this.state.selectedUser}\n              />\n            )}\n          </Tab>\n\n          <Tab eventKey=\"Attachment\" title=\"Attachment\">\n          <Button variant=\"outline-primary\" value='attachments' onClick={this.updateUserSpecialProfile.bind(this)}>Attachment</Button>\n          {this.state.userUpdateField === 'attachments' && (\n            <UpdateUserAttachmentForm\n            authUserId={this.context.userId}\n            canCancelProfile\n              canConfirm\n              onCancel={this.modalCancelHandler}\n              onConfirm={this.updateUserAttachmentHandler}\n              confirmText=\"Confirm\"\n              user={this.state.selectedUser}\n            />\n          )}\n          </Tab>\n        </Tabs>\n        </Container>\n      </Col>\n      </Row>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default ThisUserPage;\n"]},"metadata":{},"sourceType":"module"}