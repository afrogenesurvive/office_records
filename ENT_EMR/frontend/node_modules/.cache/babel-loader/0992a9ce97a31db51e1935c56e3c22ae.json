{"ast":null,"code":"import _classCallCheck from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import Button from'react-bootstrap/Button';import{NavLink}from'react-router-dom';import Form from'react-bootstrap/Form';import Row from'react-bootstrap/Row';import'./Auth.css';import AuthContext from'../context/auth-context';import AlertBox from'../components/AlertBox';var AuthPage=/*#__PURE__*/function(_Component){_inherits(AuthPage,_Component);function AuthPage(){var _getPrototypeOf2;var _this;_classCallCheck(this,AuthPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(AuthPage)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={userAlert:null};_this.submitHandler=function(event){console.log(\"login function...\");event.preventDefault();var email=event.target.formBasicEmail.value;var password=event.target.formBasicPassword.value;if(email.trim().length===0||password.trim().length===0){return;}var requestBody={query:\"\\n        query {\\n          login(email: \\\"\".concat(email,\"\\\", password: \\\"\").concat(password,\"\\\") {\\n            userId\\n            token\\n            tokenExpiration\\n          }\\n        }\\n      \")};fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql',{// fetch('http://localhost:10000/graphql', {\nmethod:'POST',body:JSON.stringify(requestBody),headers:{'Content-Type':'application/json'}}).then(function(res){if(res.status!==200&&res.status!==201){// this.context.userAlert = 'Failed!';\nthrow new Error('Failed!');}// this.context.userAlert = 'Failed!';\nreturn res.json();}).then(function(resData){var responseAlert=JSON.stringify(resData.data).slice(2,25);console.log(\"\\n          resData slice: \".concat(responseAlert,\",\\n          resData: \").concat(JSON.stringify(resData.data),\",\\n          \"));_this.setState({userAlert:responseAlert});if(resData.data.login.token){_this.context.login(resData.data.login.token,resData.data.login.userId,resData.data.login.tokenExpiration);// const sessionStorageLoginInfo = {\n//   token: resData.data.login.token,\n//   userId: resData.data.login.userId,\n//   tokenExpiration: resData.data.login.tokenExpiration\n// };\n// sessionStorage.setItem('login info', sessionStorageLoginInfo);\n// sessionStorage.setItem('login info', JSON.stringify(sessionStorageLoginInfo));\n}}).catch(function(err){console.log(err);_this.setState({userAlert:err});// this.context.userAlert = err;\n// console.log(`\n//   err: ${this.context.userAlert}\n//   `);\n});};return _this;}_createClass(AuthPage,[{key:\"render\",value:function render(){return React.createElement(Row,null,React.createElement(AlertBox,{authUserId:this.context.userId,alert:this.state.userAlert}),React.createElement(Form,{className:\"auth-form\",onSubmit:this.submitHandler},React.createElement(Form.Group,{controlId:\"formBasicEmail\"},React.createElement(Form.Label,null,\"Email address\"),React.createElement(Form.Control,{type:\"email\",placeholder:\"Enter email\"}),React.createElement(Form.Text,{className:\"text-muted\"},\"We'll never share your email with anyone else.\")),React.createElement(Form.Group,{controlId:\"formBasicPassword\"},React.createElement(Form.Label,null,\"Password\"),React.createElement(Form.Control,{type:\"password\",placeholder:\"Password\"})),React.createElement(Button,{variant:\"outline-success\",type:\"submit\",className:\"loginButton\",size:\"lg\"},\"Login\"),React.createElement(Button,{variant:\"outline-warning\",className:\"loginButton\",size:\"lg\"},React.createElement(NavLink,{to:\"/signup\"},\"Signup\"))));}}]);return AuthPage;}(Component);AuthPage.contextType=AuthContext;export default AuthPage;","map":{"version":3,"sources":["/Users/pedrojacob/Downloads/AMR/websites/office_records/ENT_EMR/frontend/src/pages/Auth.js"],"names":["React","Component","Button","NavLink","Form","Row","AuthContext","AlertBox","AuthPage","state","userAlert","submitHandler","event","console","log","preventDefault","email","target","formBasicEmail","value","password","formBasicPassword","trim","length","requestBody","query","fetch","method","body","JSON","stringify","headers","then","res","status","Error","json","resData","responseAlert","data","slice","setState","login","token","context","userId","tokenExpiration","catch","err","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Button from 'react-bootstrap/Button';\nimport { NavLink } from 'react-router-dom';\nimport Form from 'react-bootstrap/Form';\nimport Row from 'react-bootstrap/Row';\n\n\nimport './Auth.css';\nimport AuthContext from '../context/auth-context';\nimport AlertBox from '../components/AlertBox';\n\n\nclass AuthPage extends Component {\n  state = {\n    userAlert: null,\n  };\n  static contextType = AuthContext;\n\n  // constructor(props) {\n  //   super(props);\n  // }\n\n  // switchModeHandler = () => {\n  //   this.setState(prevState => {\n  //     return { isLogin: !prevState.isLogin };\n  //   });\n  // };\n\n\n  submitHandler = event => {\n    console.log(\"login function...\");\n    event.preventDefault();\n    const email = event.target.formBasicEmail.value;\n    const password = event.target.formBasicPassword.value;\n\n    if (email.trim().length === 0 || password.trim().length === 0) {\n      return;\n    }\n\n    let requestBody = {\n      query: `\n        query {\n          login(email: \"${email}\", password: \"${password}\") {\n            userId\n            token\n            tokenExpiration\n          }\n        }\n      `};\n\n    fetch('http://ec2-3-19-32-237.us-east-2.compute.amazonaws.com/graphql', {\n    // fetch('http://localhost:10000/graphql', {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    })\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          // this.context.userAlert = 'Failed!';\n          throw new Error('Failed!');\n        }\n        // this.context.userAlert = 'Failed!';\n        return res.json();\n      })\n      .then(resData => {\n        const responseAlert = JSON.stringify(resData.data).slice(2,25)\n        console.log(`\n          resData slice: ${responseAlert},\n          resData: ${JSON.stringify(resData.data)},\n          `);\n\n          this.setState({userAlert: responseAlert})\n        if (resData.data.login.token) {\n          this.context.login(\n            resData.data.login.token,\n            resData.data.login.userId,\n            resData.data.login.tokenExpiration\n          );\n\n          // const sessionStorageLoginInfo = {\n          //   token: resData.data.login.token,\n          //   userId: resData.data.login.userId,\n          //   tokenExpiration: resData.data.login.tokenExpiration\n          // };\n\n          // sessionStorage.setItem('login info', sessionStorageLoginInfo);\n          // sessionStorage.setItem('login info', JSON.stringify(sessionStorageLoginInfo));\n\n        }\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({userAlert: err});\n        // this.context.userAlert = err;\n        // console.log(`\n        //   err: ${this.context.userAlert}\n        //   `);\n      });\n  };\n\n  render() {\n    return (\n      <Row>\n      <AlertBox\n        authUserId={this.context.userId}\n        alert={this.state.userAlert}\n      />\n\n\n      <Form className=\"auth-form\" onSubmit={this.submitHandler}>\n      <Form.Group controlId=\"formBasicEmail\">\n        <Form.Label>Email address</Form.Label>\n        <Form.Control type=\"email\" placeholder=\"Enter email\"/>\n        <Form.Text className=\"text-muted\">\n          We'll never share your email with anyone else.\n        </Form.Text>\n      </Form.Group>\n\n      <Form.Group controlId=\"formBasicPassword\">\n        <Form.Label>Password</Form.Label>\n        <Form.Control type=\"password\" placeholder=\"Password\" />\n      </Form.Group>\n      <Button variant=\"outline-success\" type=\"submit\" className=\"loginButton\" size=\"lg\">\n        Login\n      </Button>\n\n      <Button variant=\"outline-warning\" className=\"loginButton\" size=\"lg\">\n        <NavLink to=\"/signup\">Signup</NavLink>\n      </Button>\n    </Form>\n\n      </Row>\n\n\n    );\n  }\n}\n\nexport default AuthPage;\n"]},"metadata":{},"sourceType":"module"}